"use strict";var te=Object.create;var O=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ie=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var re=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),se=(o,e)=>{for(var n in e)O(o,n,{get:e[n],enumerable:!0})},q=(o,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of oe(e))!ae.call(o,i)&&i!==n&&O(o,i,{get:()=>e[i],enumerable:!(t=ne(e,i))||t.enumerable});return o};var J=(o,e,n)=>(n=o!=null?te(ie(o)):{},q(e||!o||!o.__esModule?O(n,"default",{value:o,enumerable:!0}):n,o)),de=o=>q(O({},"__esModule",{value:!0}),o);var Z=re((ye,Q)=>{Q.exports=z;z.default=z;z.stable=K;z.stableStringify=K;var H="[...]",F="[Circular]",w=[],E=[];function G(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function z(o,e,n,t){typeof t>"u"&&(t=G()),I(o,"",0,[],void 0,0,t);var i;try{E.length===0?i=JSON.stringify(o,e,n):i=JSON.stringify(o,U(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;w.length!==0;){var a=w.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return i}function S(o,e,n,t){var i=Object.getOwnPropertyDescriptor(t,n);i.get!==void 0?i.configurable?(Object.defineProperty(t,n,{value:o}),w.push([t,n,e,i])):E.push([e,n,o]):(t[n]=o,w.push([t,n,e]))}function I(o,e,n,t,i,a,r){a+=1;var s;if(typeof o=="object"&&o!==null){for(s=0;s<t.length;s++)if(t[s]===o){S(F,o,e,i);return}if(typeof r.depthLimit<"u"&&a>r.depthLimit){S(H,o,e,i);return}if(typeof r.edgesLimit<"u"&&n+1>r.edgesLimit){S(H,o,e,i);return}if(t.push(o),Array.isArray(o))for(s=0;s<o.length;s++)I(o[s],s,s,t,o,a,r);else{var d=Object.keys(o);for(s=0;s<d.length;s++){var l=d[s];I(o[l],l,s,t,o,a,r)}}t.pop()}}function pe(o,e){return o<e?-1:o>e?1:0}function K(o,e,n,t){typeof t>"u"&&(t=G());var i=B(o,"",0,[],void 0,0,t)||o,a;try{E.length===0?a=JSON.stringify(i,e,n):a=JSON.stringify(i,U(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;w.length!==0;){var r=w.pop();r.length===4?Object.defineProperty(r[0],r[1],r[3]):r[0][r[1]]=r[2]}}return a}function B(o,e,n,t,i,a,r){a+=1;var s;if(typeof o=="object"&&o!==null){for(s=0;s<t.length;s++)if(t[s]===o){S(F,o,e,i);return}try{if(typeof o.toJSON=="function")return}catch{return}if(typeof r.depthLimit<"u"&&a>r.depthLimit){S(H,o,e,i);return}if(typeof r.edgesLimit<"u"&&n+1>r.edgesLimit){S(H,o,e,i);return}if(t.push(o),Array.isArray(o))for(s=0;s<o.length;s++)B(o[s],s,s,t,o,a,r);else{var d={},l=Object.keys(o).sort(pe);for(s=0;s<l.length;s++){var c=l[s];B(o[c],c,s,t,o,a,r),d[c]=o[c]}if(typeof i<"u")w.push([i,e,o]),i[e]=d;else return d}t.pop()}}function U(o){return o=typeof o<"u"?o:function(e,n){return n},function(e,n){if(E.length>0)for(var t=0;t<E.length;t++){var i=E[t];if(i[1]===e&&i[0]===n){n=i[2],E.splice(t,1);break}}return o.call(this,e,n)}}});var be={};se(be,{DebugPanel:()=>R,JsonView:()=>C,ScreenPosition:()=>V,debug:()=>ee,getWindowSize:()=>T,makeDraggable:()=>D,makeResizable:()=>$});module.exports=de(be);var le=".debug-panel{position:fixed;z-index:99999;background:#222;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:Arial,sans-serif;color:#fff;transition:transform .2s ease-in-out,visibility .2s ease-in-out}.debug-panel.visible{visibility:visible;transform:translateY(0)}.debug-panel:not(.visible){visibility:hidden;transform:translateY(10px);pointer-events:none}.debug-panel .debug-panel-tabs{display:flex;flex-wrap:wrap;background:#111;padding:5px;gap:5px;border-bottom:1px solid hsla(0,0%,100%,.1);cursor:grab;user-select:none}.debug-panel .debug-panel-tabs:active{cursor:grabbing}.debug-panel .debug-panel-tabs .debug-tab{background:#333;color:#ccc;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;transition:background .2s ease-in-out}.debug-panel .debug-panel-tabs .debug-tab:hover{background:#444;color:#fff}.debug-panel .debug-panel-tabs .debug-tab:focus{outline:none}.debug-panel .debug-panel-tabs .debug-tab.active{background:#007bff;color:#fff}.debug-panel .debug-panel-content{flex:1;display:flex;flex-direction:column;overflow-y:auto;padding:0px 15px;background:#1a1a1a}.debug-panel .debug-panel-content .debug-tab-content{display:none;flex-direction:column;flex:1;gap:5px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry{background:#292929;color:#ddd;padding:5px 8px;border-radius:4px;font-size:12px;word-break:break-word;border-left:3px solid #007bff;position:relative;display:flex;align-items:center}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-copy-button{opacity:1}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-log-entry-text{flex:1;padding-right:70px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{position:absolute;top:50%;transform:translateY(-50%);background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:12px;font-weight:bold;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#969696}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{right:36px;background:rgba(85,170,255,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#28f}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button{right:8px;background:rgba(255,85,85,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover{background:#f22}.debug-panel .debug-toolbar{display:flex;width:100%;align-items:center;justify-content:flex-end;gap:8px;padding:8px;background:#111;border-top:1px solid hsla(0,0%,100%,.1);flex-wrap:wrap}.debug-panel .debug-toolbar .debug-keyboard-hint{margin-right:auto;color:#999;font-size:11px;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container{display:flex;align-items:center;gap:5px;max-width:100px;min-width:40px;flex-shrink:1;padding:5px 0}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-label{font-size:11px;color:#999;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider{flex:1;min-width:40px;width:100%;max-width:100%;height:4px;background:#444;border-radius:2px;outline:none;-webkit-appearance:none;appearance:none}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb{width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;border:none;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-runnable-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar button{background:#d9534f;color:#fff;border:none;padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s;white-space:nowrap;flex-shrink:0}.debug-panel .debug-toolbar button:hover{background:#c9302c}.debug-panel .debug-toolbar button:focus{outline:none}.debug-panel .debug-toolbar{container-type:inline-size}@container (max-width: 350px){.debug-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel .debug-toolbar .debug-keyboard-hint{display:none}.debug-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}}.debug-panel.narrow-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel.narrow-panel .debug-toolbar .debug-keyboard-hint{margin-right:0;text-align:center}.debug-panel.narrow-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}.debug-panel .resize-handle{position:absolute;background:hsla(0,0%,100%,.1);z-index:10;transition:background .2s}.debug-panel .resize-handle:hover{background:hsla(0,0%,100%,.3)}.debug-panel .resize-left,.debug-panel .resize-right{top:0;bottom:0;width:6px;cursor:ew-resize}.debug-panel .resize-left{left:-3px}.debug-panel .resize-right{right:-3px}.debug-panel .resize-top,.debug-panel .resize-bottom{left:0;right:0;height:6px;cursor:ns-resize}.debug-panel .resize-top{top:-3px}.debug-panel .resize-bottom{bottom:-3px}.debug-panel .resize-top-left,.debug-panel .resize-top-right,.debug-panel .resize-bottom-left,.debug-panel .resize-bottom-right{width:10px;height:10px}.debug-panel .resize-top-left{left:-3px;top:-3px;cursor:nwse-resize}.debug-panel .resize-top-right{right:-3px;top:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-left{left:-3px;bottom:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-right{right:-3px;bottom:-3px;cursor:nwse-resize}.debug-state{position:relative;flex:1 0 100%;display:flex;flex-direction:column;margin-bottom:10px;margin-left:10px}.debug-state .json-toggle{position:absolute;top:7px;left:-20px;margin-right:5px;border:none;background:none;cursor:pointer;color:#888;font-size:14px;padding:0;width:20px;height:20px;transition:color .2s}.debug-state .json-toggle:hover{color:#fff}.debug-state .json-toggle:focus{outline:none}.debug-state .debug-state-label{font-size:13px;font-weight:bold;padding:5px 0;color:#ccc}.debug-state .debug-state-label:hover{color:#fff;cursor:pointer;text-decoration:underline}.debug-state .json-wrapper{padding:5px;margin-left:-15px;background:#292929;border-radius:4px;border-left:3px solid #28a745}.debug-state.collapsed .json-wrapper{display:none}";if(typeof document<"u"){let o=document.createElement("style");o.textContent=le,document.head.appendChild(o)}var ce=".json-node{position:relative;margin-left:20px;padding-left:0;font-size:12px;line-height:1.4em}.json-node .json-properties{display:flex;flex-direction:column}.json-node .json-property{position:relative;display:flex;align-items:flex-start;padding:2px 0}.json-node .json-property.object{flex-direction:column}.json-node .json-key{font-weight:bold;margin-right:5px;color:#9cdcfe}.json-node .json-key.clickable{cursor:pointer}.json-node .json-key.clickable:hover{color:#4fc3f7;text-decoration:underline}.json-node .json-value{color:#ce9178;white-space:pre-wrap;word-break:break-word;flex:1}.json-node .json-toggle{position:absolute;top:2px;left:-20px;border:none;background:none;cursor:pointer;color:#888;font-size:12px;padding:0;width:16px;height:16px;transition:color .2s}.json-node .json-toggle:hover{color:#fff}.json-node .json-toggle:focus{outline:none}.json-node .collapsed .json-properties{display:none}";if(typeof document<"u"){let o=document.createElement("style");o.textContent=ce,document.head.appendChild(o)}var N=J(require("eventbusjs"),1),_=J(Z(),1);var M=J(require("jsondiffpatch"),1),ue=()=>({expandAll:!1,expandObjects:[],useViewState:!0}),C=class{constructor(e,n,t){this.viewStates={};this.json=e,this.parentContainer=n,this.options=Object.assign({},ue(),t||{}),this.render()}render(){this.parentContainer.innerHTML="";let e=this.drawJsonNode(this.json);this.parentContainer.appendChild(e)}toggleExpandNode(e,n,t){let i=e.classList.contains("collapsed");e.classList.toggle("collapsed",!i),this.viewStates[n]=!i,t&&(t.textContent=i?"[-]":"[+]")}drawJsonNode(e,n=""){let t=document.createElement("div");t.classList.add("json-node");let i=document.createElement("div");i.classList.add("json-properties");for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a)){let r=`${n}${a}`,s=document.createElement("div");s.classList.add("json-property"),s.setAttribute("data-path",r);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=a+": ";let l=document.createElement("div");l.classList.add("json-value");let c=e[a],x=typeof c=="object"&&c!==null,b=Array.isArray(c);if(x){d.classList.add("clickable"),b?d.textContent=`${a} (${c.length})`:d.textContent=a;let f=b&&c.length>0?!0:Object.keys(c).length>0;s.classList.add("object");let u=document.createElement("button");u.classList.add("json-toggle");let p=this.drawJsonNode(c,r+"/");if(this.options.expandAll)u.textContent="[-]";else{let h=!1;b&&f?h=!0:this.options.expandObjs?.forEach(m=>{new RegExp(m).test(r)&&(h=!0)}),this.options.useViewState&&typeof this.viewStates[r]<"u"&&(h=!this.viewStates[r]),h?u.textContent="[-]":(u.textContent="[+]",p.classList.add("collapsed"))}u.onclick=()=>this.toggleExpandNode(p,r,u),d.onclick=()=>this.toggleExpandNode(p,r,u),s.appendChild(u),l.appendChild(p)}else l.textContent=String(c);s.appendChild(d),s.appendChild(l),i.appendChild(s)}return t.appendChild(i),t}updateJson(e){let n=M.diff(this.json,e);M.patch(this.json,n),this.render()}};function $(o,e={}){o.querySelectorAll(".resize-handle").forEach(g=>g.remove());let{handles:n=["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:t=1/0,maxHeight:i=1/0,minWidth:a=100,minHeight:r=100,onResize:s=()=>{}}=e,d=!1,l=null,c=0,x=0,b=0,f=0,u=0,p=0;function h(g){let y=document.createElement("div");y.classList.add("resize-handle",`resize-${g}`),y.addEventListener("mousedown",L=>m(L,g)),o.appendChild(y)}function m(g,y){d=!0,l=y,c=g.clientX,x=g.clientY,b=o.offsetWidth,f=o.offsetHeight,u=o.offsetLeft,p=o.offsetTop,g.preventDefault(),g.stopPropagation(),document.addEventListener("mousemove",j),document.addEventListener("mouseup",k)}function j(g){if(!d||!l)return;let y=b,L=f,Y=u,X=p,P=g.clientX-c,W=g.clientY-x;if(l.includes("right")&&(y=Math.min(Math.max(b+P,a),t)),l.includes("left")){let v=b-P;v>=a&&v<=t&&(y=v,Y=u+P)}if(l.includes("bottom")&&(L=Math.min(Math.max(f+W,r),i)),l.includes("top")){let v=f-W;v>=r&&v<=i&&(L=v,X=p+W)}o.style.width=`${y}px`,o.style.height=`${L}px`,o.style.left=`${Y}px`,o.style.top=`${X}px`,s(y,L)}function k(){d=!1,l=null,document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",k)}n.forEach(g=>h(g))}function D(o,e,n={}){let t=e||o,i=!1,a=0,r=0,s=0,d=0,{onDragStart:l,onDrag:c,onDragEnd:x}=n;function b(p){let h=p.target;if(h.tagName==="BUTTON"||h.closest("button"))return;i=!0,a=p.clientX,r=p.clientY;let m=getComputedStyle(o);s=parseInt(m.left)||o.offsetLeft,d=parseInt(m.top)||o.offsetTop,m.position!=="absolute"&&m.position!=="fixed"&&(o.style.position="absolute",o.style.left=`${s}px`,o.style.top=`${d}px`),p.preventDefault(),t.style.cursor="grabbing",l&&l(p),document.addEventListener("mousemove",f),document.addEventListener("mouseup",u)}function f(p){if(!i)return;let h=p.clientX-a,m=p.clientY-r,j=s+h,k=d+m;o.style.left=`${j}px`,o.style.top=`${k}px`,c&&c(j,k)}function u(){i&&(i=!1,t.style.cursor="grab",x&&x(),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",u))}return t.style.cursor="grab",t.addEventListener("mousedown",b),()=>{t.removeEventListener("mousedown",b),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",u)}}function T(){let o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:o,height:e}}var A="objects",V=(d=>(d.TopLeft="topLeft",d.Top="top",d.TopRight="topRight",d.Right="right",d.BottomRight="bottomRight",d.Bottom="bottom",d.BottomLeft="bottomLeft",d.Left="left",d))(V||{}),ge=280,R=class{constructor(e={}){this.tabEntries={};this.debugStates={};this.activeTab="global";this.options={position:"bottomRight",width:600,height:400,snap:!1,snapPadding:20,...e},this.container=this.createContainer(),this.tabContainer=this.createTabContainer(),this.contentContainer=this.createContentContainer(),this.container.appendChild(this.tabContainer),this.container.appendChild(this.contentContainer),this.toolbar=this.createGlobalToolbar(),this.container.appendChild(this.toolbar),document.body.appendChild(this.container),this.addTab(A),this.addTab("global"),this.restoreSettings(),this.setupResizable(),this.setupDraggable(),this.setupEventListeners(),this.setupKeyboardShortcut(),e.show&&!this.loadSettings()&&this.show()}createContainer(){let e=document.createElement("div");return e.classList.add("debug-panel"),e.style.width=`${this.options.width}px`,e.style.height=`${this.options.height}px`,e.style.position="fixed",e.style.opacity="1",e}createTabContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-tabs"),e}createContentContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-content"),e}createGlobalToolbar(){let e=document.createElement("div");e.classList.add("debug-toolbar");let n=document.createElement("span");n.classList.add("debug-keyboard-hint"),n.textContent="Ctrl+Alt+D to hide/show",n.style.color="#999",n.style.fontSize="11px";let t=document.createElement("div");t.classList.add("debug-opacity-container");let i=document.createElement("label");i.classList.add("debug-opacity-label"),i.textContent="O",i.style.fontSize="11px",i.style.color="#999",i.style.marginRight="5px",this.opacitySlider=document.createElement("input"),this.opacitySlider.type="range",this.opacitySlider.min="20",this.opacitySlider.max="100",this.opacitySlider.value="100",this.opacitySlider.classList.add("debug-opacity-slider"),this.opacitySlider.oninput=()=>this.handleOpacityChange(),t.appendChild(this.opacitySlider);let a=document.createElement("button");a.classList.add("debug-clear-button"),a.textContent="Clear",a.onclick=()=>this.clearCurrentTab();let r=document.createElement("button");return r.classList.add("debug-hide-button"),r.textContent="Hide",r.onclick=()=>this.hide(),e.appendChild(n),e.appendChild(t),e.appendChild(a),e.appendChild(r),e}setupResizable(){let{width:e,height:n}=T();$(this.container,{handles:["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:e-20,maxHeight:n-20,minWidth:200,minHeight:150,onResize:t=>{this.updateToolbarLayout(t),this.saveSettings()}})}setupDraggable(){this.options.snap?D(this.container,this.tabContainer,{onDrag:(e,n)=>this.handleSnapWhileDragging(e,n),onDragEnd:()=>this.saveSettings()}):D(this.container,this.tabContainer,{onDragEnd:()=>this.saveSettings()})}setupPosition(){let{width:e,height:n}=T(),t=this.options.width||600,i=this.options.height||400,a=0,r=0;switch(this.options.position){case"topLeft":a=0,r=0;break;case"top":a=(e-t)/2,r=0;break;case"topRight":a=e-t,r=0;break;case"right":a=e-t,r=(n-i)/2;break;case"bottomRight":a=e-t,r=n-i;break;case"bottom":a=(e-t)/2,r=n-i;break;case"bottomLeft":a=0,r=n-i;break;case"left":a=0,r=(n-i)/2;break}this.container.style.left=`${a}px`,this.container.style.top=`${r}px`}setupKeyboardShortcut(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.altKey&&e.key.toLowerCase()==="d"&&(e.preventDefault(),this.toggle())})}setupEventListeners(){N.default.addEventListener("log",e=>{let{namespace:n,message:t}=e.target;this.log(n,t)}),N.default.addEventListener("debug",e=>{let{id:n,state:t}=e.target;if(!n||!t){console.log("Invalid event data for debug-state. Expected {id, state}, got:",e);return}this.debug(n,t)})}restoreSettings(){let e=this.loadSettings();if(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`,this.container.style.width=`${e.width}px`,this.container.style.height=`${e.height}px`;let n=e.opacity!==void 0?e.opacity:1;this.container.style.opacity=String(n),this.opacitySlider&&(this.opacitySlider.value=String(Math.round(n*100))),e.visible?this.container.classList.add("visible"):this.container.classList.remove("visible")}else this.setupPosition()}loadSettings(){try{let e=localStorage.getItem("debugPanelSettings");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load debug panel settings:",e)}return null}saveSettings(){try{let e=parseFloat(this.container.style.opacity)||1,n={left:parseInt(this.container.style.left)||this.container.offsetLeft,top:parseInt(this.container.style.top)||this.container.offsetTop,width:this.container.offsetWidth,height:this.container.offsetHeight,visible:this.container.classList.contains("visible"),opacity:e};localStorage.setItem("debugPanelSettings",JSON.stringify(n))}catch(e){console.error("Failed to save debug panel settings:",e)}}debug(e,n){let t=e,i=(0,_.default)(n),a=JSON.parse(i);this.debugStates[t]?this.updateDebugState(t,a):this.addDebugState(t,a)}updateDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${A}"]`);if(!t){console.error("No content for debug namespace.");return}let i=t.querySelector(`#debug-state-${e}`);if(!i){console.error(`No debug state found for ${e}.`);return}let a=i.querySelector(".json-wrapper");if(!a){console.error(`No json wrapper found for existing state ${e}`);return}a.innerHTML="",this.debugStates[e].state=n,this.debugStates[e].jsonView.updateJson(n)}addDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${A}"]`);if(!t){console.error("No content for debug namespace.");return}let i=document.createElement("div");i.classList.add("debug-state"),i.setAttribute("id",`debug-state-${e}`);let a=()=>{let c=this.debugStates[e].isExpanded;this.debugStates[e].isExpanded=!c,i.classList.toggle("collapsed",c),r.textContent=c?"[+]":"[-]"},r=document.createElement("button");r.classList.add("json-toggle"),r.textContent="[-]",r.onclick=a,i.appendChild(r);let s=document.createElement("div");s.classList.add("debug-state-label"),s.innerText=e||"untitled",s.onclick=a,i.appendChild(s);let d=document.createElement("div");d.classList.add("json-wrapper"),i.appendChild(d);let l=new C(n,d,{expandObjs:[/children/,/children\/(.*)/,/entry/]});this.debugStates[e]={state:n,jsonView:l,isExpanded:!0},t.appendChild(i)}addTab(e){if(this.tabEntries[e])return;this.tabEntries[e]=[];let n=document.createElement("button");n.classList.add("debug-tab"),n.textContent=e,n.onclick=()=>this.switchTab(e),this.tabContainer.appendChild(n);let t=document.createElement("div");t.classList.add("debug-tab-content"),t.dataset.namespace=e,this.contentContainer.appendChild(t),Object.keys(this.tabEntries).length===1&&this.switchTab(e)}clearCurrentTab(){this.clearTab(this.activeTab)}clearTab(e){let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(this.tabEntries[e]=[],e===A&&Object.keys(this.debugStates).forEach(t=>{delete this.debugStates[t]}),n.innerHTML="")}switchTab(e){this.activeTab=e,this.tabContainer.querySelectorAll(".debug-tab").forEach((t,i)=>{let a=Object.keys(this.tabEntries)[i];t.classList.toggle("active",a===e)}),this.contentContainer.querySelectorAll(".debug-tab-content").forEach(t=>{t.style.display="none"});let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(n.style.display="block")}log(e,n){this.tabEntries[e]||this.addTab(e);let t={id:`${e}-${Date.now()}-${Math.random()}`,message:n,timestamp:new Date};this.tabEntries[e].push(t);let i=this.contentContainer.querySelector(`[data-namespace="${e}"]`);if(!i)return;let a=this.createLogElement(t,e);i.appendChild(a),e!=="global"&&this.log("global",n)}createLogElement(e,n){let t=document.createElement("div");t.classList.add("debug-log-entry"),t.dataset.logId=e.id;let i=document.createElement("div");i.innerText=`[${e.timestamp.toLocaleTimeString()}] ${this.renderLogEntry(e.message)}`,i.classList.add("debug-log-entry-text");let a=document.createElement("button");a.innerText="\u{1F4CB}",a.classList.add("debug-copy-button"),a.onclick=()=>navigator.clipboard.writeText(i.innerText);let r=document.createElement("button");return r.innerText="\u274C",r.classList.add("debug-delete-button"),r.onclick=()=>this.removeLogEntry(n,e.id,t),t.appendChild(i),t.appendChild(a),t.appendChild(r),t}removeLogEntry(e,n,t){this.tabEntries[e]=this.tabEntries[e].filter(i=>i.id!==n),t.remove()}renderLogEntry(e){return Array.isArray(e)?e.join(" "):typeof e=="object"?(0,_.default)(e):String(e)}updateToolbarLayout(e){e<ge?this.container.classList.add("narrow-panel"):this.container.classList.remove("narrow-panel")}handleOpacityChange(){let n=parseInt(this.opacitySlider.value)/100;this.container.classList.contains("visible")&&(this.container.style.opacity=String(n)),this.saveSettings()}handleSnapWhileDragging(e,n){let t=this.options.snapPadding||20,{width:i,height:a}=T(),r=this.container.offsetWidth,s=this.container.offsetHeight,d=e,l=n;e<t?d=0:e+r>i-t&&(d=i-r),n<t?l=0:n+s>a-t&&(l=a-s),(d!==e||l!==n)&&(this.container.style.left=`${d}px`,this.container.style.top=`${l}px`)}show(){this.container.classList.add("visible");let e=parseFloat(this.container.style.opacity)||1;this.container.style.opacity=String(e),this.saveSettings()}hide(){this.container.classList.remove("visible"),this.saveSettings()}toggle(){this.container.classList.contains("visible")?this.hide():this.show()}};function ee(o,e){N.default.dispatch("debug",{idOrState:o,state:e})}
//# sourceMappingURL=index.cjs.js.map
