"use strict";var te=Object.create;var O=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ie=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var se=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),re=(i,e)=>{for(var n in e)O(i,n,{get:e[n],enumerable:!0})},X=(i,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of oe(e))!ae.call(i,o)&&o!==n&&O(i,o,{get:()=>e[o],enumerable:!(t=ne(e,o))||t.enumerable});return i};var J=(i,e,n)=>(n=i!=null?te(ie(i)):{},X(e||!i||!i.__esModule?O(n,"default",{value:i,enumerable:!0}):n,i)),de=i=>X(O({},"__esModule",{value:!0}),i);var Z=se((ye,Q)=>{Q.exports=z;z.default=z;z.stable=K;z.stableStringify=K;var M="[...]",F="[Circular]",L=[],E=[];function G(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function z(i,e,n,t){typeof t>"u"&&(t=G()),I(i,"",0,[],void 0,0,t);var o;try{E.length===0?o=JSON.stringify(i,e,n):o=JSON.stringify(i,U(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;L.length!==0;){var a=L.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return o}function C(i,e,n,t){var o=Object.getOwnPropertyDescriptor(t,n);o.get!==void 0?o.configurable?(Object.defineProperty(t,n,{value:i}),L.push([t,n,e,o])):E.push([e,n,i]):(t[n]=i,L.push([t,n,e]))}function I(i,e,n,t,o,a,s){a+=1;var r;if(typeof i=="object"&&i!==null){for(r=0;r<t.length;r++)if(t[r]===i){C(F,i,e,o);return}if(typeof s.depthLimit<"u"&&a>s.depthLimit){C(M,i,e,o);return}if(typeof s.edgesLimit<"u"&&n+1>s.edgesLimit){C(M,i,e,o);return}if(t.push(i),Array.isArray(i))for(r=0;r<i.length;r++)I(i[r],r,r,t,i,a,s);else{var d=Object.keys(i);for(r=0;r<d.length;r++){var c=d[r];I(i[c],c,r,t,i,a,s)}}t.pop()}}function pe(i,e){return i<e?-1:i>e?1:0}function K(i,e,n,t){typeof t>"u"&&(t=G());var o=B(i,"",0,[],void 0,0,t)||i,a;try{E.length===0?a=JSON.stringify(o,e,n):a=JSON.stringify(o,U(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;L.length!==0;){var s=L.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return a}function B(i,e,n,t,o,a,s){a+=1;var r;if(typeof i=="object"&&i!==null){for(r=0;r<t.length;r++)if(t[r]===i){C(F,i,e,o);return}try{if(typeof i.toJSON=="function")return}catch{return}if(typeof s.depthLimit<"u"&&a>s.depthLimit){C(M,i,e,o);return}if(typeof s.edgesLimit<"u"&&n+1>s.edgesLimit){C(M,i,e,o);return}if(t.push(i),Array.isArray(i))for(r=0;r<i.length;r++)B(i[r],r,r,t,i,a,s);else{var d={},c=Object.keys(i).sort(pe);for(r=0;r<c.length;r++){var l=c[r];B(i[l],l,r,t,i,a,s),d[l]=i[l]}if(typeof o<"u")L.push([o,e,i]),o[e]=d;else return d}t.pop()}}function U(i){return i=typeof i<"u"?i:function(e,n){return n},function(e,n){if(E.length>0)for(var t=0;t<E.length;t++){var o=E[t];if(o[1]===e&&o[0]===n){n=o[2],E.splice(t,1);break}}return i.call(this,e,n)}}});var be={};re(be,{DebugPanel:()=>R,JsonView:()=>S,ScreenPosition:()=>_,debug:()=>ee,getWindowSize:()=>j,makeDraggable:()=>H,makeResizable:()=>A});module.exports=de(be);var le=".debug-panel{position:fixed;z-index:99999;background:#222;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:Arial,sans-serif;color:#fff;transition:transform .2s ease-in-out,visibility .2s ease-in-out}.debug-panel.visible{visibility:visible;transform:translateY(0)}.debug-panel:not(.visible){visibility:hidden;transform:translateY(10px);pointer-events:none}.debug-panel .debug-panel-tabs{display:flex;flex-wrap:wrap;background:#111;padding:5px;gap:5px;border-bottom:1px solid hsla(0,0%,100%,.1);cursor:grab;user-select:none}.debug-panel .debug-panel-tabs:active{cursor:grabbing}.debug-panel .debug-panel-tabs .debug-tab{background:#333;color:#ccc;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;transition:background .2s ease-in-out}.debug-panel .debug-panel-tabs .debug-tab:hover{background:#444;color:#fff}.debug-panel .debug-panel-tabs .debug-tab:focus{outline:none}.debug-panel .debug-panel-tabs .debug-tab.active{background:#007bff;color:#fff}.debug-panel .debug-panel-content{flex:1;display:flex;flex-direction:column;overflow-y:auto;padding:0px 15px;background:#1a1a1a}.debug-panel .debug-panel-content .debug-tab-content{display:none;flex-direction:column;flex:1;gap:5px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry{background:#292929;color:#ddd;padding:5px 8px;border-radius:4px;font-size:12px;word-break:break-word;border-left:3px solid #007bff;position:relative;display:flex;align-items:center}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-copy-button{opacity:1}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-log-entry-text{flex:1;padding-right:70px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{position:absolute;top:50%;transform:translateY(-50%);background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:12px;font-weight:bold;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#969696}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{right:36px;background:rgba(85,170,255,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#28f}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button{right:8px;background:rgba(255,85,85,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover{background:#f22}.debug-panel .debug-toolbar{display:flex;width:100%;align-items:center;justify-content:flex-end;gap:8px;padding:8px;background:#111;border-top:1px solid hsla(0,0%,100%,.1);flex-wrap:wrap}.debug-panel .debug-toolbar .debug-keyboard-hint{margin-right:auto;color:#999;font-size:11px;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container{display:flex;align-items:center;gap:5px;max-width:100px;min-width:40px;flex-shrink:1;padding:5px 0}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-label{font-size:11px;color:#999;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider{flex:1;min-width:40px;width:100%;max-width:100%;height:4px;background:#444;border-radius:2px;outline:none;-webkit-appearance:none;appearance:none}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb{width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;border:none;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-runnable-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar button{background:#d9534f;color:#fff;border:none;padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s;white-space:nowrap;flex-shrink:0}.debug-panel .debug-toolbar button:hover{background:#c9302c}.debug-panel .debug-toolbar button:focus{outline:none}.debug-panel .debug-toolbar{container-type:inline-size}@container (max-width: 350px){.debug-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel .debug-toolbar .debug-keyboard-hint{display:none}.debug-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}}.debug-panel.narrow-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel.narrow-panel .debug-toolbar .debug-keyboard-hint{margin-right:0;text-align:center}.debug-panel.narrow-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}.debug-panel .resize-handle{position:absolute;background:hsla(0,0%,100%,.1);z-index:10;transition:background .2s}.debug-panel .resize-handle:hover{background:hsla(0,0%,100%,.3)}.debug-panel .resize-left,.debug-panel .resize-right{top:0;bottom:0;width:6px;cursor:ew-resize}.debug-panel .resize-left{left:-3px}.debug-panel .resize-right{right:-3px}.debug-panel .resize-top,.debug-panel .resize-bottom{left:0;right:0;height:6px;cursor:ns-resize}.debug-panel .resize-top{top:-3px}.debug-panel .resize-bottom{bottom:-3px}.debug-panel .resize-top-left,.debug-panel .resize-top-right,.debug-panel .resize-bottom-left,.debug-panel .resize-bottom-right{width:10px;height:10px}.debug-panel .resize-top-left{left:-3px;top:-3px;cursor:nwse-resize}.debug-panel .resize-top-right{right:-3px;top:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-left{left:-3px;bottom:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-right{right:-3px;bottom:-3px;cursor:nwse-resize}.debug-state{position:relative;flex:1 0 100%;display:flex;flex-direction:column;margin-bottom:10px;margin-left:10px}.debug-state .json-toggle{position:absolute;top:7px;left:-20px;margin-right:5px;border:none;background:none;cursor:pointer;color:#888;font-size:14px;padding:0;width:20px;height:20px;transition:color .2s}.debug-state .json-toggle:hover{color:#fff}.debug-state .json-toggle:focus{outline:none}.debug-state .debug-state-label{font-size:13px;font-weight:bold;padding:5px 0;color:#ccc}.debug-state .debug-state-label:hover{color:#fff;cursor:pointer;text-decoration:underline}.debug-state .json-wrapper{padding:5px;margin-left:-15px;background:#292929;border-radius:4px;border-left:3px solid #28a745}.debug-state.collapsed .json-wrapper{display:none}";if(typeof document<"u"){let i=document.createElement("style");i.textContent=le,document.head.appendChild(i)}var ce=".json-node{position:relative;margin-left:20px;padding-left:0;font-size:12px;line-height:1.4em}.json-node .json-properties{display:flex;flex-direction:column}.json-node .json-property{position:relative;display:flex;align-items:flex-start;padding:2px 0}.json-node .json-property.object{flex-direction:column}.json-node .json-key{font-weight:bold;margin-right:5px;color:#9cdcfe}.json-node .json-key.clickable{cursor:pointer}.json-node .json-key.clickable:hover{color:#4fc3f7;text-decoration:underline}.json-node .json-value{color:#ce9178;white-space:pre-wrap;word-break:break-word;flex:1}.json-node .json-toggle{position:absolute;top:2px;left:-20px;border:none;background:none;cursor:pointer;color:#888;font-size:12px;padding:0;width:16px;height:16px;transition:color .2s}.json-node .json-toggle:hover{color:#fff}.json-node .json-toggle:focus{outline:none}.json-node .collapsed .json-properties{display:none}";if(typeof document<"u"){let i=document.createElement("style");i.textContent=ce,document.head.appendChild(i)}var N=J(require("eventbusjs"),1),q=J(Z(),1);var D=J(require("jsondiffpatch"),1),ue=()=>({expandAll:!1,expandObjects:[],useViewState:!0}),S=class{constructor(e,n,t){this.viewStates={};this.json=e,this.parentContainer=n,this.options=Object.assign({},ue(),t||{}),this.render()}render(){this.parentContainer.innerHTML="";let e=this.drawJsonNode(this.json);this.parentContainer.appendChild(e)}toggleExpandNode(e,n,t){let o=e.classList.contains("collapsed");e.classList.toggle("collapsed",!o),this.viewStates[n]=!o,t&&(t.textContent=o?"[-]":"[+]")}drawJsonNode(e,n=""){let t=document.createElement("div");t.classList.add("json-node");let o=document.createElement("div");o.classList.add("json-properties");for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a)){let s=`${n}${a}`,r=document.createElement("div");r.classList.add("json-property"),r.setAttribute("data-path",s);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=a+": ";let c=document.createElement("div");c.classList.add("json-value");let l=e[a],b=typeof l=="object"&&l!==null,p=Array.isArray(l);if(b){d.classList.add("clickable"),p?d.textContent=`${a} (${l.length})`:d.textContent=a;let u=p&&l.length>0?!0:Object.keys(l).length>0;r.classList.add("object");let h=document.createElement("button");h.classList.add("json-toggle");let g=this.drawJsonNode(l,s+"/");if(this.options.expandAll)h.textContent="[-]";else{let m=!1;p&&u?m=!0:this.options.expandObjs?.forEach(y=>{new RegExp(y).test(s)&&(m=!0)}),this.options.useViewState&&typeof this.viewStates[s]<"u"&&(m=!this.viewStates[s]),m?h.textContent="[-]":(h.textContent="[+]",g.classList.add("collapsed"))}h.onclick=()=>this.toggleExpandNode(g,s,h),d.onclick=()=>this.toggleExpandNode(g,s,h),r.appendChild(h),c.appendChild(g)}else c.textContent=String(l);r.appendChild(d),r.appendChild(c),o.appendChild(r)}return t.appendChild(o),t}updateJson(e){let n=D.diff(this.json,e);n&&(D.patch(this.json,n),this.patchDOM(n))}patchDOM(e,n=""){for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;let o=e[t],a=n?`${n}${t}`:t;if(t==="_t")continue;let s=this.parentContainer.querySelector(`.json-property[data-path="${a}"]`);Array.isArray(o)?o.length===2?this.updateValueNode(s,a,this.getValueAtPath(this.json,a)):o.length===3&&o[1]===0&&o[2]===0?s&&s.remove():o.length===1&&this.addPropertyNode(a,o[0]):typeof o=="object"&&this.patchDOM(o,a+"/")}}getValueAtPath(e,n){let t=n.split("/").filter(a=>a),o=e;for(let a of t){if(o==null)return;o=o[a]}return o}updateValueNode(e,n,t){if(!e)return;let o=e.querySelector(".json-value");if(!o)return;if(typeof t=="object"&&t!==null){let s=n.split("/").filter(u=>u).pop()||"",r=n.substring(0,n.lastIndexOf(s));o.innerHTML="",e.classList.add("object");let d=e.querySelector(".json-key"),c=Array.isArray(t);d&&(d.classList.add("clickable"),c?d.textContent=`${s} (${t.length})`:d.textContent=s);let l=e.querySelector(".json-toggle");l||(l=document.createElement("button"),l.classList.add("json-toggle"),e.insertBefore(l,d));let b=this.drawJsonNode(t,n+"/"),p=this.viewStates[n];typeof p<"u"&&p?l.textContent="[-]":(l.textContent="[+]",b.classList.add("collapsed")),l.onclick=()=>this.toggleExpandNode(b,n,l),d&&(d.onclick=()=>this.toggleExpandNode(b,n,l)),o.appendChild(b)}else{e.classList.remove("object");let s=e.querySelector(".json-toggle");s&&s.remove(),o.innerHTML="",o.textContent=String(t)}}addPropertyNode(e,n){let t=e.split("/").filter(p=>p),o=t.pop()||"",a=t.join("/"),s;if(a){let p=this.parentContainer.querySelector(`.json-property[data-path="${a}"]`);if(p)s=p.querySelector(".json-properties");else return}else s=this.parentContainer.querySelector(".json-properties");if(!s)return;let r=document.createElement("div");r.classList.add("json-property"),r.setAttribute("data-path",e);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=o+": ";let c=document.createElement("div");c.classList.add("json-value");let l=typeof n=="object"&&n!==null,b=Array.isArray(n);if(l){d.classList.add("clickable"),b?d.textContent=`${o} (${n.length})`:d.textContent=o,r.classList.add("object");let p=document.createElement("button");p.classList.add("json-toggle"),p.textContent="[+]";let u=this.drawJsonNode(n,e+"/");u.classList.add("collapsed"),p.onclick=()=>this.toggleExpandNode(u,e,p),d.onclick=()=>this.toggleExpandNode(u,e,p),r.appendChild(p),c.appendChild(u)}else c.textContent=String(n);r.appendChild(d),r.appendChild(c),s.appendChild(r)}};function A(i,e={}){i.querySelectorAll(".resize-handle").forEach(f=>f.remove());let{handles:n=["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:t=1/0,maxHeight:o=1/0,minWidth:a=100,minHeight:s=100,onResize:r=()=>{}}=e,d=!1,c=null,l=0,b=0,p=0,u=0,h=0,g=0;function m(f){let x=document.createElement("div");x.classList.add("resize-handle",`resize-${f}`),x.addEventListener("mousedown",w=>y(w,f)),i.appendChild(x)}function y(f,x){d=!0,c=x,l=f.clientX,b=f.clientY,p=i.offsetWidth,u=i.offsetHeight,h=i.offsetLeft,g=i.offsetTop,f.preventDefault(),f.stopPropagation(),document.addEventListener("mousemove",T),document.addEventListener("mouseup",k)}function T(f){if(!d||!c)return;let x=p,w=u,Y=h,V=g,P=f.clientX-l,W=f.clientY-b;if(c.includes("right")&&(x=Math.min(Math.max(p+P,a),t)),c.includes("left")){let v=p-P;v>=a&&v<=t&&(x=v,Y=h+P)}if(c.includes("bottom")&&(w=Math.min(Math.max(u+W,s),o)),c.includes("top")){let v=u-W;v>=s&&v<=o&&(w=v,V=g+W)}i.style.width=`${x}px`,i.style.height=`${w}px`,i.style.left=`${Y}px`,i.style.top=`${V}px`,r(x,w)}function k(){d=!1,c=null,document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",k)}n.forEach(f=>m(f))}function H(i,e,n={}){let t=e||i,o=!1,a=0,s=0,r=0,d=0,{onDragStart:c,onDrag:l,onDragEnd:b}=n;function p(g){let m=g.target;if(m.tagName==="BUTTON"||m.closest("button"))return;o=!0,a=g.clientX,s=g.clientY;let y=getComputedStyle(i);r=parseInt(y.left)||i.offsetLeft,d=parseInt(y.top)||i.offsetTop,y.position!=="absolute"&&y.position!=="fixed"&&(i.style.position="absolute",i.style.left=`${r}px`,i.style.top=`${d}px`),g.preventDefault(),t.style.cursor="grabbing",c&&c(g),document.addEventListener("mousemove",u),document.addEventListener("mouseup",h)}function u(g){if(!o)return;let m=g.clientX-a,y=g.clientY-s,T=r+m,k=d+y;i.style.left=`${T}px`,i.style.top=`${k}px`,l&&l(T,k)}function h(){o&&(o=!1,t.style.cursor="grab",b&&b(),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",h))}return t.style.cursor="grab",t.addEventListener("mousedown",p),()=>{t.removeEventListener("mousedown",p),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",h)}}function j(){let i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:i,height:e}}var $="objects",_=(d=>(d.TopLeft="topLeft",d.Top="top",d.TopRight="topRight",d.Right="right",d.BottomRight="bottomRight",d.Bottom="bottom",d.BottomLeft="bottomLeft",d.Left="left",d))(_||{}),ge=280,R=class{constructor(e={}){this.tabEntries={};this.debugStates={};this.activeTab="global";this.options={position:"bottomRight",width:600,height:400,snap:!1,snapPadding:20,...e},this.container=this.createContainer(),this.tabContainer=this.createTabContainer(),this.contentContainer=this.createContentContainer(),this.container.appendChild(this.tabContainer),this.container.appendChild(this.contentContainer),this.toolbar=this.createGlobalToolbar(),this.container.appendChild(this.toolbar),document.body.appendChild(this.container),this.addTab($),this.addTab("global"),this.restoreSettings(),this.setupResizable(),this.setupDraggable(),this.setupEventListeners(),this.setupKeyboardShortcut(),e.show&&!this.loadSettings()&&this.show()}createContainer(){let e=document.createElement("div");return e.classList.add("debug-panel"),e.style.width=`${this.options.width}px`,e.style.height=`${this.options.height}px`,e.style.position="fixed",e.style.opacity="1",e}createTabContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-tabs"),e}createContentContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-content"),e}createGlobalToolbar(){let e=document.createElement("div");e.classList.add("debug-toolbar");let n=document.createElement("span");n.classList.add("debug-keyboard-hint"),n.textContent="Ctrl+Alt+D to hide/show",n.style.color="#999",n.style.fontSize="11px";let t=document.createElement("div");t.classList.add("debug-opacity-container");let o=document.createElement("label");o.classList.add("debug-opacity-label"),o.textContent="O",o.style.fontSize="11px",o.style.color="#999",o.style.marginRight="5px",this.opacitySlider=document.createElement("input"),this.opacitySlider.type="range",this.opacitySlider.min="20",this.opacitySlider.max="100",this.opacitySlider.value="100",this.opacitySlider.classList.add("debug-opacity-slider"),this.opacitySlider.oninput=()=>this.handleOpacityChange(),t.appendChild(this.opacitySlider);let a=document.createElement("button");a.classList.add("debug-clear-button"),a.textContent="Clear",a.onclick=()=>this.clearCurrentTab();let s=document.createElement("button");return s.classList.add("debug-hide-button"),s.textContent="Hide",s.onclick=()=>this.hide(),e.appendChild(n),e.appendChild(t),e.appendChild(a),e.appendChild(s),e}setupResizable(){let{width:e,height:n}=j();A(this.container,{handles:["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:e-20,maxHeight:n-20,minWidth:200,minHeight:150,onResize:t=>{this.updateToolbarLayout(t),this.saveSettings()}})}setupDraggable(){this.options.snap?H(this.container,this.tabContainer,{onDrag:(e,n)=>this.handleSnapWhileDragging(e,n),onDragEnd:()=>this.saveSettings()}):H(this.container,this.tabContainer,{onDragEnd:()=>this.saveSettings()})}setupPosition(){let{width:e,height:n}=j(),t=this.options.width||600,o=this.options.height||400,a=0,s=0;switch(this.options.position){case"topLeft":a=0,s=0;break;case"top":a=(e-t)/2,s=0;break;case"topRight":a=e-t,s=0;break;case"right":a=e-t,s=(n-o)/2;break;case"bottomRight":a=e-t,s=n-o;break;case"bottom":a=(e-t)/2,s=n-o;break;case"bottomLeft":a=0,s=n-o;break;case"left":a=0,s=(n-o)/2;break}this.container.style.left=`${a}px`,this.container.style.top=`${s}px`}setupKeyboardShortcut(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.altKey&&e.key.toLowerCase()==="d"&&(e.preventDefault(),this.toggle())})}setupEventListeners(){N.default.addEventListener("log",e=>{let{namespace:n,message:t}=e.target;this.log(n,t)}),N.default.addEventListener("debug",e=>{let{id:n,state:t}=e.target;if(!n||!t){console.log("Invalid event data for debug-state. Expected {id, state}, got:",e);return}this.debug(n,t)})}restoreSettings(){let e=this.loadSettings();if(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`,this.container.style.width=`${e.width}px`,this.container.style.height=`${e.height}px`;let n=e.opacity!==void 0?e.opacity:1;this.container.style.opacity=String(n),this.opacitySlider&&(this.opacitySlider.value=String(Math.round(n*100))),e.visible?this.container.classList.add("visible"):this.container.classList.remove("visible")}else this.setupPosition()}loadSettings(){try{let e=localStorage.getItem("debugPanelSettings");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load debug panel settings:",e)}return null}saveSettings(){try{let e=parseFloat(this.container.style.opacity)||1,n={left:parseInt(this.container.style.left)||this.container.offsetLeft,top:parseInt(this.container.style.top)||this.container.offsetTop,width:this.container.offsetWidth,height:this.container.offsetHeight,visible:this.container.classList.contains("visible"),opacity:e};localStorage.setItem("debugPanelSettings",JSON.stringify(n))}catch(e){console.error("Failed to save debug panel settings:",e)}}debug(e,n){let t=e,o=(0,q.default)(n),a=JSON.parse(o);this.debugStates[t]?this.updateDebugState(t,a):this.addDebugState(t,a)}updateDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${$}"]`);if(!t){console.error("No content for debug namespace.");return}let o=t.querySelector(`#debug-state-${e}`);if(!o){console.error(`No debug state found for ${e}.`);return}let a=o.querySelector(".json-wrapper");if(!a){console.error(`No json wrapper found for existing state ${e}`);return}a.innerHTML="",this.debugStates[e].state=n,this.debugStates[e].jsonView.updateJson(n)}addDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${$}"]`);if(!t){console.error("No content for debug namespace.");return}let o=document.createElement("div");o.classList.add("debug-state"),o.setAttribute("id",`debug-state-${e}`);let a=()=>{let l=this.debugStates[e].isExpanded;this.debugStates[e].isExpanded=!l,o.classList.toggle("collapsed",l),s.textContent=l?"[+]":"[-]"},s=document.createElement("button");s.classList.add("json-toggle"),s.textContent="[-]",s.onclick=a,o.appendChild(s);let r=document.createElement("div");r.classList.add("debug-state-label"),r.innerText=e||"untitled",r.onclick=a,o.appendChild(r);let d=document.createElement("div");d.classList.add("json-wrapper"),o.appendChild(d);let c=new S(n,d,{});this.debugStates[e]={state:n,jsonView:c,isExpanded:!0},t.appendChild(o)}addTab(e){if(this.tabEntries[e])return;this.tabEntries[e]=[];let n=document.createElement("button");n.classList.add("debug-tab"),n.textContent=e,n.onclick=()=>this.switchTab(e),this.tabContainer.appendChild(n);let t=document.createElement("div");t.classList.add("debug-tab-content"),t.dataset.namespace=e,this.contentContainer.appendChild(t),Object.keys(this.tabEntries).length===1&&this.switchTab(e)}clearCurrentTab(){this.clearTab(this.activeTab)}clearTab(e){let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(this.tabEntries[e]=[],e===$&&Object.keys(this.debugStates).forEach(t=>{delete this.debugStates[t]}),n.innerHTML="")}switchTab(e){this.activeTab=e,this.tabContainer.querySelectorAll(".debug-tab").forEach((t,o)=>{let a=Object.keys(this.tabEntries)[o];t.classList.toggle("active",a===e)}),this.contentContainer.querySelectorAll(".debug-tab-content").forEach(t=>{t.style.display="none"});let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(n.style.display="block")}log(e,n){this.tabEntries[e]||this.addTab(e);let t={id:`${e}-${Date.now()}-${Math.random()}`,message:n,timestamp:new Date};this.tabEntries[e].push(t);let o=this.contentContainer.querySelector(`[data-namespace="${e}"]`);if(!o)return;let a=this.createLogElement(t,e);o.appendChild(a),e!=="global"&&this.log("global",n)}createLogElement(e,n){let t=document.createElement("div");t.classList.add("debug-log-entry"),t.dataset.logId=e.id;let o=document.createElement("div");o.innerText=`[${e.timestamp.toLocaleTimeString()}] ${this.renderLogEntry(e.message)}`,o.classList.add("debug-log-entry-text");let a=document.createElement("button");a.innerText="\u{1F4CB}",a.classList.add("debug-copy-button"),a.onclick=()=>navigator.clipboard.writeText(o.innerText);let s=document.createElement("button");return s.innerText="\u274C",s.classList.add("debug-delete-button"),s.onclick=()=>this.removeLogEntry(n,e.id,t),t.appendChild(o),t.appendChild(a),t.appendChild(s),t}removeLogEntry(e,n,t){this.tabEntries[e]=this.tabEntries[e].filter(o=>o.id!==n),t.remove()}renderLogEntry(e){return Array.isArray(e)?e.join(" "):typeof e=="object"?(0,q.default)(e):String(e)}updateToolbarLayout(e){e<ge?this.container.classList.add("narrow-panel"):this.container.classList.remove("narrow-panel")}handleOpacityChange(){let n=parseInt(this.opacitySlider.value)/100;this.container.classList.contains("visible")&&(this.container.style.opacity=String(n)),this.saveSettings()}handleSnapWhileDragging(e,n){console.log("snap");let t=this.options.snapPadding||20,{width:o,height:a}=j(),s=this.container.offsetWidth,r=this.container.offsetHeight,d=e,c=n;e<t?d=0:e+s>o-t&&(d=o-s),n<t?c=0:n+r>a-t&&(c=a-r),(d!==e||c!==n)&&(this.container.style.left=`${d}px`,this.container.style.top=`${c}px`)}show(){this.container.classList.add("visible");let e=parseFloat(this.container.style.opacity)||1;this.container.style.opacity=String(e),this.saveSettings()}hide(){this.container.classList.remove("visible"),this.saveSettings()}toggle(){this.container.classList.contains("visible")?this.hide():this.show()}};function ee(i,e){N.default.dispatch("debug",{id:i,state:e})}
//# sourceMappingURL=index.cjs.js.map
