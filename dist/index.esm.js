var Q=Object.create;var q=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,ne=Object.prototype.hasOwnProperty;var oe=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var ie=(i,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ee(e))!ne.call(i,o)&&o!==n&&q(i,o,{get:()=>e[o],enumerable:!(t=Z(e,o))||t.enumerable});return i};var re=(i,e,n)=>(n=i!=null?Q(te(i)):{},ie(e||!i||!i.__esModule?q(n,"default",{value:i,enumerable:!0}):n,i));var G=oe((he,F)=>{F.exports=T;T.default=T;T.stable=V;T.stableStringify=V;var H="[...]",_="[Circular]",L=[],E=[];function Y(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function T(i,e,n,t){typeof t>"u"&&(t=Y()),N(i,"",0,[],void 0,0,t);var o;try{E.length===0?o=JSON.stringify(i,e,n):o=JSON.stringify(i,X(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;L.length!==0;){var r=L.pop();r.length===4?Object.defineProperty(r[0],r[1],r[3]):r[0][r[1]]=r[2]}}return o}function j(i,e,n,t){var o=Object.getOwnPropertyDescriptor(t,n);o.get!==void 0?o.configurable?(Object.defineProperty(t,n,{value:i}),L.push([t,n,e,o])):E.push([e,n,i]):(t[n]=i,L.push([t,n,e]))}function N(i,e,n,t,o,r,a){r+=1;var s;if(typeof i=="object"&&i!==null){for(s=0;s<t.length;s++)if(t[s]===i){j(_,i,e,o);return}if(typeof a.depthLimit<"u"&&r>a.depthLimit){j(H,i,e,o);return}if(typeof a.edgesLimit<"u"&&n+1>a.edgesLimit){j(H,i,e,o);return}if(t.push(i),Array.isArray(i))for(s=0;s<i.length;s++)N(i[s],s,s,t,i,r,a);else{var d=Object.keys(i);for(s=0;s<d.length;s++){var c=d[s];N(i[c],c,s,t,i,r,a)}}t.pop()}}function de(i,e){return i<e?-1:i>e?1:0}function V(i,e,n,t){typeof t>"u"&&(t=Y());var o=R(i,"",0,[],void 0,0,t)||i,r;try{E.length===0?r=JSON.stringify(o,e,n):r=JSON.stringify(o,X(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;L.length!==0;){var a=L.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return r}function R(i,e,n,t,o,r,a){r+=1;var s;if(typeof i=="object"&&i!==null){for(s=0;s<t.length;s++)if(t[s]===i){j(_,i,e,o);return}try{if(typeof i.toJSON=="function")return}catch{return}if(typeof a.depthLimit<"u"&&r>a.depthLimit){j(H,i,e,o);return}if(typeof a.edgesLimit<"u"&&n+1>a.edgesLimit){j(H,i,e,o);return}if(t.push(i),Array.isArray(i))for(s=0;s<i.length;s++)R(i[s],s,s,t,i,r,a);else{var d={},c=Object.keys(i).sort(de);for(s=0;s<c.length;s++){var l=c[s];R(i[l],l,s,t,i,r,a),d[l]=i[l]}if(typeof o<"u")L.push([o,e,i]),o[e]=d;else return d}t.pop()}}function X(i){return i=typeof i<"u"?i:function(e,n){return n},function(e,n){if(E.length>0)for(var t=0;t<E.length;t++){var o=E[t];if(o[1]===e&&o[0]===n){n=o[2],E.splice(t,1);break}}return i.call(this,e,n)}}});var ae=".debug-panel{position:fixed;z-index:99999;background:#222;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:Arial,sans-serif;color:#fff;transition:transform .2s ease-in-out,visibility .2s ease-in-out}.debug-panel.visible{visibility:visible;transform:translateY(0)}.debug-panel:not(.visible){visibility:hidden;transform:translateY(10px);pointer-events:none}.debug-panel .debug-panel-tabs{display:flex;flex-wrap:wrap;background:#111;padding:5px;gap:5px;border-bottom:1px solid hsla(0,0%,100%,.1);cursor:grab;user-select:none}.debug-panel .debug-panel-tabs:active{cursor:grabbing}.debug-panel .debug-panel-tabs .debug-tab{background:#333;color:#ccc;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;transition:background .2s ease-in-out}.debug-panel .debug-panel-tabs .debug-tab:hover{background:#444;color:#fff}.debug-panel .debug-panel-tabs .debug-tab:focus{outline:none}.debug-panel .debug-panel-tabs .debug-tab.active{background:#007bff;color:#fff}.debug-panel .debug-panel-content{flex:1;display:flex;flex-direction:column;overflow-y:auto;padding:0px 15px;background:#1a1a1a}.debug-panel .debug-panel-content .debug-tab-content{display:none;flex-direction:column;flex:1;gap:5px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry{background:#292929;color:#ddd;padding:5px 8px;border-radius:4px;font-size:12px;word-break:break-word;border-left:3px solid #007bff;position:relative;display:flex;align-items:center}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-copy-button{opacity:1}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-log-entry-text{flex:1;padding-right:70px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{position:absolute;top:50%;transform:translateY(-50%);background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:12px;font-weight:bold;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#969696}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{right:36px;background:rgba(85,170,255,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#28f}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button{right:8px;background:rgba(255,85,85,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover{background:#f22}.debug-panel .debug-toolbar{display:flex;width:100%;align-items:center;justify-content:flex-end;gap:8px;padding:8px;background:#111;border-top:1px solid hsla(0,0%,100%,.1);flex-wrap:wrap}.debug-panel .debug-toolbar .debug-keyboard-hint{margin-right:auto;color:#999;font-size:11px;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container{display:flex;align-items:center;gap:5px;max-width:100px;min-width:40px;flex-shrink:1;padding:5px 0}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-label{font-size:11px;color:#999;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider{flex:1;min-width:40px;width:100%;max-width:100%;height:4px;background:#444;border-radius:2px;outline:none;-webkit-appearance:none;appearance:none}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb{width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;border:none;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-runnable-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar button{background:#d9534f;color:#fff;border:none;padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s;white-space:nowrap;flex-shrink:0}.debug-panel .debug-toolbar button:hover{background:#c9302c}.debug-panel .debug-toolbar button:focus{outline:none}.debug-panel .debug-toolbar{container-type:inline-size}@container (max-width: 350px){.debug-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel .debug-toolbar .debug-keyboard-hint{display:none}.debug-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}}.debug-panel.narrow-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel.narrow-panel .debug-toolbar .debug-keyboard-hint{margin-right:0;text-align:center}.debug-panel.narrow-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}.debug-panel .resize-handle{position:absolute;background:hsla(0,0%,100%,.1);z-index:10;transition:background .2s}.debug-panel .resize-handle:hover{background:hsla(0,0%,100%,.3)}.debug-panel .resize-left,.debug-panel .resize-right{top:0;bottom:0;width:6px;cursor:ew-resize}.debug-panel .resize-left{left:-3px}.debug-panel .resize-right{right:-3px}.debug-panel .resize-top,.debug-panel .resize-bottom{left:0;right:0;height:6px;cursor:ns-resize}.debug-panel .resize-top{top:-3px}.debug-panel .resize-bottom{bottom:-3px}.debug-panel .resize-top-left,.debug-panel .resize-top-right,.debug-panel .resize-bottom-left,.debug-panel .resize-bottom-right{width:10px;height:10px}.debug-panel .resize-top-left{left:-3px;top:-3px;cursor:nwse-resize}.debug-panel .resize-top-right{right:-3px;top:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-left{left:-3px;bottom:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-right{right:-3px;bottom:-3px;cursor:nwse-resize}.debug-state{position:relative;flex:1 0 100%;display:flex;flex-direction:column;margin-bottom:10px;margin-left:10px}.debug-state .json-toggle{position:absolute;top:2px;left:-22px;margin:0 10px 0 0;border:none;background:none;cursor:pointer;color:#888;font-size:14px;padding:0;width:20px;height:20px;transition:color .2s}.debug-state .json-toggle:hover{color:#fff}.debug-state .json-toggle:focus{outline:none}.debug-state .debug-state-label{font-size:13px;font-weight:bold;padding:5px 0;color:#ccc}.debug-state .debug-state-label:hover{color:#fff;cursor:pointer;text-decoration:underline}.debug-state .json-wrapper{padding:5px;margin-left:-15px;background:#292929;border-radius:4px;border-left:3px solid #28a745}.debug-state.collapsed .json-wrapper{display:none}";if(typeof document<"u"){let i=document.createElement("style");i.textContent=ae,document.head.appendChild(i)}var se=".json-node{position:relative;margin-left:20px;padding-left:0;font-size:12px;line-height:1.2em}.json-node .json-properties{display:flex;flex-direction:column}.json-node .json-property{position:relative;display:flex;align-items:flex-start;padding:2px 0}.json-node .json-property.object{flex-direction:column}.json-node .json-key{font-weight:bold;margin-right:5px;color:#9cdcfe}.json-node .json-key.clickable{cursor:pointer}.json-node .json-key.clickable:hover{color:#4fc3f7;text-decoration:underline}.json-node .json-value{color:#ce9178;white-space:pre-wrap;word-break:break-word;flex:1}.json-node .json-toggle{position:absolute;top:0px;left:-22px;border:none;background:none;cursor:pointer;color:#888;font-size:12px;padding:0;width:20px;height:20px;transition:color .2s}.json-node .json-toggle:hover{color:#fff}.json-node .json-toggle:focus{outline:none}.json-node .collapsed .json-properties{display:none}";if(typeof document<"u"){let i=document.createElement("style");i.textContent=se,document.head.appendChild(i)}var K=re(G(),1);import W from"eventbusjs";import*as M from"jsondiffpatch";var le=()=>({expandAll:!1,expandObjects:[],useViewState:!0}),k=class{constructor(e,n,t){this.viewStates={};this.json=e,this.parentContainer=n,this.options=Object.assign({},le(),t||{}),this.render()}render(){this.parentContainer.innerHTML="";let e=this.drawJsonNode(this.json);this.parentContainer.appendChild(e)}toggleExpandNode(e,n,t){let o=e.classList.contains("collapsed");e.classList.toggle("collapsed",!o),this.viewStates[n]=!o,t&&(t.textContent=o?"[-]":"[+]")}drawJsonNode(e,n=""){let t=document.createElement("div");t.classList.add("json-node");let o=document.createElement("div");o.classList.add("json-properties");for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let a=`${n}${r}`,s=document.createElement("div");s.classList.add("json-property"),s.setAttribute("data-path",a);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=r+": ";let c=document.createElement("div");c.classList.add("json-value");let l=e[r],h=typeof l=="object"&&l!==null,p=Array.isArray(l);if(h){d.classList.add("clickable"),p?d.textContent=`${r} (${l.length})`:d.textContent=r;let g=p&&l.length>0?!0:Object.keys(l).length>0;s.classList.add("object");let f=document.createElement("button");f.classList.add("json-toggle");let b=this.drawJsonNode(l,a+"/");if(this.options.expandAll)f.textContent="[-]";else{let m=!1;p&&g?m=!0:this.options.expandObjs?.forEach(y=>{new RegExp(y).test(a)&&(m=!0)}),this.options.useViewState&&typeof this.viewStates[a]<"u"&&(m=!this.viewStates[a]),m?f.textContent="[-]":(f.textContent="[+]",b.classList.add("collapsed"))}f.onclick=()=>this.toggleExpandNode(b,a,f),d.onclick=()=>this.toggleExpandNode(b,a,f),s.appendChild(f),c.appendChild(b)}else c.textContent=String(l);s.appendChild(d),s.appendChild(c),o.appendChild(s)}return t.appendChild(o),t}updateJson(e){let n=M.diff(this.json,e);n&&(M.patch(this.json,n),this.patchDOM(n))}patchDOM(e,n=""){for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;let o=e[t],r=n?`${n}${t}`:t;if(t==="_t")continue;let a=this.parentContainer.querySelector(`.json-property[data-path="${r}"]`);Array.isArray(o)?o.length===2?this.updateValueNode(a,r,this.getValueAtPath(this.json,r)):o.length===3&&o[1]===0&&o[2]===0?a&&a.remove():o.length===1&&this.addPropertyNode(r,o[0]):typeof o=="object"&&this.patchDOM(o,r+"/")}}getValueAtPath(e,n){let t=n.split("/").filter(r=>r),o=e;for(let r of t){if(o==null)return;o=o[r]}return o}updateValueNode(e,n,t){if(!e)return;let o=e.querySelector(".json-value");if(!o)return;if(typeof t=="object"&&t!==null){let a=n.split("/").filter(g=>g).pop()||"",s=n.substring(0,n.lastIndexOf(a));o.innerHTML="",e.classList.add("object");let d=e.querySelector(".json-key"),c=Array.isArray(t);d&&(d.classList.add("clickable"),c?d.textContent=`${a} (${t.length})`:d.textContent=a);let l=e.querySelector(".json-toggle");l||(l=document.createElement("button"),l.classList.add("json-toggle"),e.insertBefore(l,d));let h=this.drawJsonNode(t,n+"/"),p=this.viewStates[n];typeof p<"u"&&p?l.textContent="[-]":(l.textContent="[+]",h.classList.add("collapsed")),l.onclick=()=>this.toggleExpandNode(h,n,l),d&&(d.onclick=()=>this.toggleExpandNode(h,n,l)),o.appendChild(h)}else{e.classList.remove("object");let a=e.querySelector(".json-toggle");a&&a.remove(),o.innerHTML="",o.textContent=String(t)}}addPropertyNode(e,n){let t=e.split("/").filter(p=>p),o=t.pop()||"",r=t.join("/"),a;if(r){let p=this.parentContainer.querySelector(`.json-property[data-path="${r}"]`);if(p)a=p.querySelector(".json-properties");else return}else a=this.parentContainer.querySelector(".json-properties");if(!a)return;let s=document.createElement("div");s.classList.add("json-property"),s.setAttribute("data-path",e);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=o+": ";let c=document.createElement("div");c.classList.add("json-value");let l=typeof n=="object"&&n!==null,h=Array.isArray(n);if(l){d.classList.add("clickable"),h?d.textContent=`${o} (${n.length})`:d.textContent=o,s.classList.add("object");let p=document.createElement("button");p.classList.add("json-toggle"),p.textContent="[+]";let g=this.drawJsonNode(n,e+"/");g.classList.add("collapsed"),p.onclick=()=>this.toggleExpandNode(g,e,p),d.onclick=()=>this.toggleExpandNode(g,e,p),s.appendChild(p),c.appendChild(g)}else c.textContent=String(n);s.appendChild(d),s.appendChild(c),a.appendChild(s)}};function P(i,e={}){i.querySelectorAll(".resize-handle").forEach(u=>u.remove());let{handles:n=["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:t=1/0,maxHeight:o=1/0,minWidth:r=100,minHeight:a=100,onResize:s=()=>{}}=e,d=!1,c=null,l=0,h=0,p=0,g=0,f=0,b=0;function m(u){let x=document.createElement("div");x.classList.add("resize-handle",`resize-${u}`),x.addEventListener("mousedown",S=>y(S,u)),i.appendChild(x)}function y(u,x){d=!0,c=x,l=u.clientX,h=u.clientY,p=i.offsetWidth,g=i.offsetHeight,f=i.offsetLeft,b=i.offsetTop,u.preventDefault(),u.stopPropagation(),document.addEventListener("mousemove",w),document.addEventListener("mouseup",C)}function w(u){if(!d||!c)return;let x=p,S=g,I=f,B=b,A=u.clientX-l,$=u.clientY-h;if(c.includes("right")&&(x=Math.min(Math.max(p+A,r),t)),c.includes("left")){let v=p-A;v>=r&&v<=t&&(x=v,I=f+A)}if(c.includes("bottom")&&(S=Math.min(Math.max(g+$,a),o)),c.includes("top")){let v=g-$;v>=a&&v<=o&&(S=v,B=b+$)}i.style.width=`${x}px`,i.style.height=`${S}px`,i.style.left=`${I}px`,i.style.top=`${B}px`,s(x,S)}function C(){d=!1,c=null,document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",C)}n.forEach(u=>m(u))}function O(i,e,n={}){let t=e||i,o=!1,r=0,a=0,s=0,d=0,{onDragStart:c,onDrag:l,onDragEnd:h}=n;function p(b){let m=b.target;if(m.tagName==="BUTTON"||m.closest("button"))return;o=!0,r=b.clientX,a=b.clientY;let y=getComputedStyle(i);s=parseInt(y.left)||i.offsetLeft,d=parseInt(y.top)||i.offsetTop,y.position!=="absolute"&&y.position!=="fixed"&&(i.style.position="absolute",i.style.left=`${s}px`,i.style.top=`${d}px`),b.preventDefault(),t.style.cursor="grabbing",c&&c(b),document.addEventListener("mousemove",g),document.addEventListener("mouseup",f)}function g(b){if(!o)return;let m=b.clientX-r,y=b.clientY-a,w=s+m,C=d+y;if(l){let u=l(w,C);u&&typeof u=="object"&&(typeof u.x=="number"&&(w=u.x),typeof u.y=="number"&&(C=u.y))}i.style.left=`${w}px`,i.style.top=`${C}px`}function f(){o&&(o=!1,t.style.cursor="grab",h&&h(),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f))}return t.style.cursor="grab",t.addEventListener("mousedown",p),()=>{t.removeEventListener("mousedown",p),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)}}function z(){let i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:i,height:e}}var D="objects",U=(d=>(d.TopLeft="topLeft",d.Top="top",d.TopRight="topRight",d.Right="right",d.BottomRight="bottomRight",d.Bottom="bottom",d.BottomLeft="bottomLeft",d.Left="left",d))(U||{}),ce=280,J=class{constructor(e={}){this.tabEntries={};this.debugStates={};this.activeTab="global";this.options={position:"bottomRight",width:600,height:400,snap:!0,snapPadding:20,...e},this.container=this.createContainer(),this.tabContainer=this.createTabContainer(),this.contentContainer=this.createContentContainer(),this.container.appendChild(this.tabContainer),this.container.appendChild(this.contentContainer),this.toolbar=this.createGlobalToolbar(),this.container.appendChild(this.toolbar),document.body.appendChild(this.container),this.addTab(D),this.addTab("global"),this.restoreSettings(),this.setupResizable(),this.setupDraggable(),this.setupEventListeners(),this.setupKeyboardShortcut(),e.show&&!this.loadSettings()&&this.show()}createContainer(){let e=document.createElement("div");return e.classList.add("debug-panel"),e.style.width=`${this.options.width}px`,e.style.height=`${this.options.height}px`,e.style.position="fixed",e.style.opacity="1",e}createTabContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-tabs"),e}createContentContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-content"),e}createGlobalToolbar(){let e=document.createElement("div");e.classList.add("debug-toolbar");let n=document.createElement("span");n.classList.add("debug-keyboard-hint"),n.textContent="Ctrl+Alt+D to hide/show",n.style.color="#999",n.style.fontSize="11px";let t=document.createElement("div");t.classList.add("debug-opacity-container");let o=document.createElement("label");o.classList.add("debug-opacity-label"),o.textContent="O",o.style.fontSize="11px",o.style.color="#999",o.style.marginRight="5px",this.opacitySlider=document.createElement("input"),this.opacitySlider.type="range",this.opacitySlider.min="20",this.opacitySlider.max="100",this.opacitySlider.value="100",this.opacitySlider.classList.add("debug-opacity-slider"),this.opacitySlider.oninput=()=>this.handleOpacityChange(),t.appendChild(this.opacitySlider);let r=document.createElement("button");r.classList.add("debug-clear-button"),r.textContent="Clear",r.onclick=()=>this.clearCurrentTab();let a=document.createElement("button");return a.classList.add("debug-hide-button"),a.textContent="Hide",a.onclick=()=>this.hide(),e.appendChild(n),e.appendChild(t),e.appendChild(r),e.appendChild(a),e}setupEventListeners(){W.addEventListener("log",e=>{let{namespace:n,message:t}=e.target;this.log(n,t)}),W.addEventListener("debug",e=>{let{id:n,state:t}=e.target;if(!n||!t){console.log("Invalid event data for debug-state. Expected {id, state}, got:",e);return}this.debug(n,t)})}setupResizable(){let{width:e,height:n}=z();P(this.container,{handles:["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:e-20,maxHeight:n-20,minWidth:200,minHeight:150,onResize:t=>{this.updateToolbarLayout(t),this.saveSettings()}})}setupDraggable(){this.options.snap?O(this.container,this.tabContainer,{onDrag:(e,n)=>this.handleSnapWhileDragging(e,n),onDragEnd:()=>this.saveSettings()}):O(this.container,this.tabContainer,{onDragEnd:()=>this.saveSettings()})}setupPosition(){let{width:e,height:n}=z(),t=this.options.width||600,o=this.options.height||400,r=0,a=0;switch(this.options.position){case"topLeft":r=0,a=0;break;case"top":r=(e-t)/2,a=0;break;case"topRight":r=e-t,a=0;break;case"right":r=e-t,a=(n-o)/2;break;case"bottomRight":r=e-t,a=n-o;break;case"bottom":r=(e-t)/2,a=n-o;break;case"bottomLeft":r=0,a=n-o;break;case"left":r=0,a=(n-o)/2;break}this.container.style.left=`${r}px`,this.container.style.top=`${a}px`}setupKeyboardShortcut(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.altKey&&e.key.toLowerCase()==="d"&&(e.preventDefault(),this.toggle())})}restoreSettings(){let e=this.loadSettings();if(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`,this.container.style.width=`${e.width}px`,this.container.style.height=`${e.height}px`;let n=e.opacity!==void 0?e.opacity:1;this.container.style.opacity=String(n),this.opacitySlider&&(this.opacitySlider.value=String(Math.round(n*100))),e.visible?this.container.classList.add("visible"):this.container.classList.remove("visible")}else this.setupPosition()}loadSettings(){try{let e=localStorage.getItem("debugPanelSettings");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load debug panel settings:",e)}return null}saveSettings(){try{let e=parseFloat(this.container.style.opacity)||1,n={left:parseInt(this.container.style.left)||this.container.offsetLeft,top:parseInt(this.container.style.top)||this.container.offsetTop,width:this.container.offsetWidth,height:this.container.offsetHeight,visible:this.container.classList.contains("visible"),opacity:e};localStorage.setItem("debugPanelSettings",JSON.stringify(n))}catch(e){console.error("Failed to save debug panel settings:",e)}}debug(e,n){let t=e,o=n;!n&&typeof e=="object"&&(t="object",o=e),this.debugStates[t]?this.updateDebugState(t,o):this.addDebugState(t,o)}updateDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${D}"]`);if(!t){console.error("No content for debug namespace.");return}let o=t.querySelector(`#debug-state-${e}`);if(!o){console.error(`No debug state found for ${e}.`);return}let r=o.querySelector(".json-wrapper");if(!r){console.error(`No json wrapper found for existing state ${e}`);return}r.innerHTML="",this.debugStates[e].state=n,this.debugStates[e].jsonView.updateJson(n)}addDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${D}"]`);if(!t){console.error("No content for debug namespace.");return}let o=document.createElement("div");o.classList.add("debug-state"),o.setAttribute("id",`debug-state-${e}`);let r=()=>{let l=this.debugStates[e].isExpanded;this.debugStates[e].isExpanded=!l,o.classList.toggle("collapsed",l),a.textContent=l?"[+]":"[-]"},a=document.createElement("button");a.classList.add("json-toggle"),a.textContent="[-]",a.onclick=r,o.appendChild(a);let s=document.createElement("div");s.classList.add("debug-state-label"),s.innerText=e||"untitled",s.onclick=r,o.appendChild(s);let d=document.createElement("div");d.classList.add("json-wrapper"),o.appendChild(d);let c=new k(n,d,{});this.debugStates[e]={state:n,jsonView:c,isExpanded:!0},t.appendChild(o)}addTab(e){if(this.tabEntries[e])return;this.tabEntries[e]=[];let n=document.createElement("button");n.classList.add("debug-tab"),n.textContent=e,n.onclick=()=>this.switchTab(e),this.tabContainer.appendChild(n);let t=document.createElement("div");t.classList.add("debug-tab-content"),t.dataset.namespace=e,this.contentContainer.appendChild(t),Object.keys(this.tabEntries).length===1&&this.switchTab(e)}clearCurrentTab(){this.clearTab(this.activeTab)}clearTab(e){let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(this.tabEntries[e]=[],e===D&&Object.keys(this.debugStates).forEach(t=>{delete this.debugStates[t]}),n.innerHTML="")}switchTab(e){this.activeTab=e,this.tabContainer.querySelectorAll(".debug-tab").forEach((t,o)=>{let r=Object.keys(this.tabEntries)[o];t.classList.toggle("active",r===e)}),this.contentContainer.querySelectorAll(".debug-tab-content").forEach(t=>{t.style.display="none"});let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(n.style.display="block")}log(e,n){this.tabEntries[e]||this.addTab(e);let t={id:`${e}-${Date.now()}-${Math.random()}`,message:n,timestamp:new Date};this.tabEntries[e].push(t);let o=this.contentContainer.querySelector(`[data-namespace="${e}"]`);if(!o)return;let r=this.createLogElement(t,e);o.appendChild(r),e!=="global"&&this.log("global",n)}createLogElement(e,n){let t=document.createElement("div");t.classList.add("debug-log-entry"),t.dataset.logId=e.id;let o=document.createElement("div");o.innerText=`[${e.timestamp.toLocaleTimeString()}] ${this.renderLogEntry(e.message)}`,o.classList.add("debug-log-entry-text");let r=document.createElement("button");r.innerText="\u{1F4CB}",r.classList.add("debug-copy-button"),r.onclick=()=>navigator.clipboard.writeText(o.innerText);let a=document.createElement("button");return a.innerText="\u274C",a.classList.add("debug-delete-button"),a.onclick=()=>this.removeLogEntry(n,e.id,t),t.appendChild(o),t.appendChild(r),t.appendChild(a),t}removeLogEntry(e,n,t){this.tabEntries[e]=this.tabEntries[e].filter(o=>o.id!==n),t.remove()}renderLogEntry(e){return Array.isArray(e)?e.join(" "):typeof e=="object"?(0,K.default)(e):String(e)}updateToolbarLayout(e){e<ce?this.container.classList.add("narrow-panel"):this.container.classList.remove("narrow-panel")}handleOpacityChange(){let n=parseInt(this.opacitySlider.value)/100;this.container.classList.contains("visible")&&(this.container.style.opacity=String(n)),this.saveSettings()}handleSnapWhileDragging(e,n){let t=this.options.snapPadding||20,{width:o,height:r}=z(),a=this.container.offsetWidth,s=this.container.offsetHeight,d=e,c=n;return e<t?d=0:e+a>o-t&&(d=o-a),n<t?c=0:n+s>r-t&&(c=r-s),{x:d,y:c}}show(){this.container.classList.add("visible");let e=parseFloat(this.container.style.opacity)||1;this.container.style.opacity=String(e),this.saveSettings()}hide(){this.container.classList.remove("visible"),this.saveSettings()}toggle(){this.container.classList.contains("visible")?this.hide():this.show()}};function pe(i,e){W.dispatch("debug",{id:i,state:e})}export{J as DebugPanel,k as JsonView,U as ScreenPosition,pe as debug,z as getWindowSize,O as makeDraggable,P as makeResizable};
//# sourceMappingURL=index.esm.js.map
