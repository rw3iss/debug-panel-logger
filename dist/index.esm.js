var ee=Object.create;var X=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ie=Object.prototype.hasOwnProperty;var se=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var ae=(i,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ne(e))!ie.call(i,o)&&o!==n&&X(i,o,{get:()=>e[o],enumerable:!(t=te(e,o))||t.enumerable});return i};var re=(i,e,n)=>(n=i!=null?ee(oe(i)):{},ae(e||!i||!i.__esModule?X(n,"default",{value:i,enumerable:!0}):n,i));var K=se((me,U)=>{U.exports=D;D.default=D;D.stable=F;D.stableStringify=F;var O="[...]",V="[Circular]",C=[],w=[];function Y(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function D(i,e,n,t){typeof t>"u"&&(t=Y()),I(i,"",0,[],void 0,0,t);var o;try{w.length===0?o=JSON.stringify(i,e,n):o=JSON.stringify(i,G(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;C.length!==0;){var s=C.pop();s.length===4?Object.defineProperty(s[0],s[1],s[3]):s[0][s[1]]=s[2]}}return o}function k(i,e,n,t){var o=Object.getOwnPropertyDescriptor(t,n);o.get!==void 0?o.configurable?(Object.defineProperty(t,n,{value:i}),C.push([t,n,e,o])):w.push([e,n,i]):(t[n]=i,C.push([t,n,e]))}function I(i,e,n,t,o,s,a){s+=1;var r;if(typeof i=="object"&&i!==null){for(r=0;r<t.length;r++)if(t[r]===i){k(V,i,e,o);return}if(typeof a.depthLimit<"u"&&s>a.depthLimit){k(O,i,e,o);return}if(typeof a.edgesLimit<"u"&&n+1>a.edgesLimit){k(O,i,e,o);return}if(t.push(i),Array.isArray(i))for(r=0;r<i.length;r++)I(i[r],r,r,t,i,s,a);else{var d=Object.keys(i);for(r=0;r<d.length;r++){var c=d[r];I(i[c],c,r,t,i,s,a)}}t.pop()}}function ce(i,e){return i<e?-1:i>e?1:0}function F(i,e,n,t){typeof t>"u"&&(t=Y());var o=P(i,"",0,[],void 0,0,t)||i,s;try{w.length===0?s=JSON.stringify(o,e,n):s=JSON.stringify(o,G(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;C.length!==0;){var a=C.pop();a.length===4?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return s}function P(i,e,n,t,o,s,a){s+=1;var r;if(typeof i=="object"&&i!==null){for(r=0;r<t.length;r++)if(t[r]===i){k(V,i,e,o);return}try{if(typeof i.toJSON=="function")return}catch{return}if(typeof a.depthLimit<"u"&&s>a.depthLimit){k(O,i,e,o);return}if(typeof a.edgesLimit<"u"&&n+1>a.edgesLimit){k(O,i,e,o);return}if(t.push(i),Array.isArray(i))for(r=0;r<i.length;r++)P(i[r],r,r,t,i,s,a);else{var d={},c=Object.keys(i).sort(ce);for(r=0;r<c.length;r++){var l=c[r];P(i[l],l,r,t,i,s,a),d[l]=i[l]}if(typeof o<"u")C.push([o,e,i]),o[e]=d;else return d}t.pop()}}function G(i){return i=typeof i<"u"?i:function(e,n){return n},function(e,n){if(w.length>0)for(var t=0;t<w.length;t++){var o=w[t];if(o[1]===e&&o[0]===n){n=o[2],w.splice(t,1);break}}return i.call(this,e,n)}}});var de='.debug-panel{position:fixed;z-index:99999;background:#222;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:Arial,sans-serif;color:#fff;transition:transform .2s ease-in-out,visibility .2s ease-in-out}.debug-panel.visible{visibility:visible;transform:translateY(0)}.debug-panel:not(.visible){visibility:hidden;transform:translateY(10px);pointer-events:none}.debug-panel .debug-panel-tabs{display:flex;flex-wrap:wrap;background:#1a1a1a;padding:6px 6px 0 6px;gap:3px;cursor:grab;user-select:none}.debug-panel .debug-panel-tabs:active{cursor:grabbing}.debug-panel .debug-panel-tabs .debug-tab{background:#2d2d2d;color:#888;padding:7px 8px;border:none;border-top-left-radius:6px;border-top-right-radius:6px;cursor:pointer;position:relative;box-shadow:inset 0 -2px 4px rgba(0,0,0,.3);font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif}.debug-panel .debug-panel-tabs .debug-tab:hover{background:#353535;color:#aaa}.debug-panel .debug-panel-tabs .debug-tab:focus{outline:none}.debug-panel .debug-panel-tabs .debug-tab.active{background:linear-gradient(to bottom, #3f6d9c, #24384d);color:#fff;box-shadow:0 -3px 8px rgba(0,102,204,.4),inset 0 1px 0 hsla(0,0%,100%,.2);z-index:1}.debug-panel .debug-panel-content{flex:1;display:flex;flex-direction:column;overflow-y:auto;padding:0px 15px;background:#0d0d0d}.debug-panel .debug-panel-content .debug-tab-content{display:none;flex-direction:column;flex:1;gap:5px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry{background:#292929;color:#ddd;padding:5px 8px;border-radius:4px;font-size:12px;word-break:break-word;border-left:3px solid #007bff;position:relative;display:flex;align-items:center}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-copy-button{opacity:1}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-log-entry-text{flex:1;padding-right:70px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{position:absolute;top:50%;transform:translateY(-50%);background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:12px;font-weight:bold;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#969696}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{right:36px;background:rgba(85,170,255,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#28f}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button{right:8px;background:rgba(223,161,152,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover{background:#f22}.debug-panel .debug-toolbar{display:flex;width:100%;align-items:center;justify-content:flex-end;gap:8px;padding:8px;background:#111;border-top:1px solid hsla(0,0%,100%,.1);flex-wrap:wrap}.debug-panel .debug-toolbar .debug-keyboard-hint{margin-right:auto;color:#999;font-size:11px;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container{display:flex;align-items:center;gap:5px;max-width:100px;min-width:40px;flex-shrink:1;padding:5px 0}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-label{font-size:11px;color:#999;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider{flex:1;min-width:40px;width:100%;max-width:100%;height:4px;background:#444;border-radius:2px;outline:none;-webkit-appearance:none;appearance:none}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb{width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;border:none;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-runnable-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar button{background:#d9534f;color:#fff;border:none;padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s;white-space:nowrap;flex-shrink:0}.debug-panel .debug-toolbar button:hover{background:#c9302c}.debug-panel .debug-toolbar button:focus{outline:none}.debug-panel .debug-toolbar{container-type:inline-size}@container (max-width: 350px){.debug-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel .debug-toolbar .debug-keyboard-hint{display:none}.debug-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}}.debug-panel.narrow-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel.narrow-panel .debug-toolbar .debug-keyboard-hint{margin-right:0;text-align:center}.debug-panel.narrow-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}.debug-panel .resize-handle{position:absolute;background:hsla(0,0%,100%,.1);z-index:10;transition:background .2s}.debug-panel .resize-handle:hover{background:hsla(0,0%,100%,.3)}.debug-panel .resize-left,.debug-panel .resize-right{top:0;bottom:0;width:6px;cursor:ew-resize}.debug-panel .resize-left{left:-3px}.debug-panel .resize-right{right:-3px}.debug-panel .resize-top,.debug-panel .resize-bottom{left:0;right:0;height:6px;cursor:ns-resize}.debug-panel .resize-top{top:-3px}.debug-panel .resize-bottom{bottom:-3px}.debug-panel .resize-top-left,.debug-panel .resize-top-right,.debug-panel .resize-bottom-left,.debug-panel .resize-bottom-right{width:10px;height:10px}.debug-panel .resize-top-left{left:-3px;top:-3px;cursor:nwse-resize}.debug-panel .resize-top-right{right:-3px;top:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-left{left:-3px;bottom:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-right{right:-3px;bottom:-3px;cursor:nwse-resize}.debug-state{position:relative;flex:1 0 100%;display:flex;flex-direction:column;margin-bottom:5px;margin-left:10px}.debug-state .json-toggle{position:absolute;top:2px;left:-22px;margin:0 10px 0 0;border:none;background:none;cursor:pointer;color:#888;font-size:14px;padding:0;width:20px;height:20px;transition:color .2s}.debug-state .json-toggle:hover{color:#fff}.debug-state .json-toggle:focus{outline:none}.debug-state .debug-state-label{font-size:13px;font-weight:bold;padding:5px 0;color:#ccc}.debug-state .debug-state-label:hover{color:#fff;cursor:pointer;text-decoration:underline}.debug-state .json-wrapper{position:relative;padding:5px;margin-left:-15px;background:#292929;border-radius:4px;border-left:3px solid #28a745}.debug-state .json-wrapper .debug-state-hover-actions{position:absolute;top:4px;right:4px;display:flex;gap:6px;opacity:0;transition:opacity .2s ease-in-out;z-index:10}.debug-state .json-wrapper:hover .debug-state-hover-actions{opacity:1}.debug-state .json-wrapper .debug-state-action-button{background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:16px;width:28px;height:28px;border-radius:4px;display:flex;align-items:center;justify-content:center;padding:0;transition:background .2s ease-in-out,transform .1s ease-in-out}.debug-state .json-wrapper .debug-state-action-button:hover{transform:scale(1.1)}.debug-state .json-wrapper .debug-state-action-button:active{transform:scale(0.95)}.debug-state .json-wrapper .debug-state-action-button:focus{outline:none}.debug-state .json-wrapper .debug-state-copy-button{background:rgba(85,170,255,.8)}.debug-state .json-wrapper .debug-state-copy-button:hover{background:#28f}.debug-state .json-wrapper .debug-state-delete-button{background:rgba(255,85,85,.8)}.debug-state .json-wrapper .debug-state-delete-button:hover{background:#f22}.debug-state.collapsed .json-wrapper{display:none}';if(typeof document<"u"){let i=document.createElement("style");i.textContent=de,document.head.appendChild(i)}var le=".json-node{position:relative;margin-left:20px;padding-left:0;font-size:12px;line-height:1.2em}.json-node .json-properties{display:flex;flex-direction:column}.json-node .json-property{position:relative;display:flex;align-items:flex-start;padding:2px 0}.json-node .json-property.object{flex-direction:column}.json-node .json-key{font-weight:bold;margin-right:5px;color:#9cdcfe}.json-node .json-key.clickable{cursor:pointer}.json-node .json-key.clickable:hover{color:#4fc3f7;text-decoration:underline}.json-node .json-value{color:#ce9178;white-space:pre-wrap;word-break:break-word;flex:1}.json-node .json-toggle{position:absolute;top:0px;left:-22px;border:none;background:none;cursor:pointer;color:#888;font-size:12px;padding:0;width:20px;height:20px;transition:color .2s}.json-node .json-toggle:hover{color:#fff}.json-node .json-toggle:focus{outline:none}.json-node .collapsed .json-properties{display:none}";if(typeof document<"u"){let i=document.createElement("style");i.textContent=le,document.head.appendChild(i)}var Q=re(K(),1);import B from"eventbusjs";import*as H from"jsondiffpatch";var v="\u25BA",L="\u25BC";var pe=()=>({expandAll:!1,expandObjects:[],useViewState:!0}),M=class{constructor(e,n,t){this.viewStates={};this.json=e,this.parentContainer=n,this.options=Object.assign({},pe(),t||{}),this.render()}render(){this.parentContainer.innerHTML="";let e=this.drawJsonNode(this.json);this.parentContainer.appendChild(e)}toggleExpandNode(e,n,t){let o=e.classList.contains("collapsed");e.classList.toggle("collapsed",!o),this.viewStates[n]=!o,t&&(t.textContent=o?v:L)}drawJsonNode(e,n=""){let t=document.createElement("div");t.classList.add("json-node");let o=document.createElement("div");o.classList.add("json-properties");for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s)){let a=`${n}${s}`,r=document.createElement("div");r.classList.add("json-property"),r.setAttribute("data-path",a);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=s+": ";let c=document.createElement("div");c.classList.add("json-value");let l=e[s],u=typeof l=="object"&&l!==null,p=Array.isArray(l);if(u){d.classList.add("clickable"),p?d.textContent=`${s} (${l.length})`:d.textContent=s;let g=p&&l.length>0?!0:Object.keys(l).length>0;r.classList.add("object");let f=document.createElement("button");f.classList.add("json-toggle");let h=this.drawJsonNode(l,a+"/");if(this.options.expandAll)f.textContent=L;else{let m=!1;p&&g?m=!0:this.options.expandObjs?.forEach(y=>{new RegExp(y).test(a)&&(m=!0)}),this.options.useViewState&&typeof this.viewStates[a]<"u"&&(m=!this.viewStates[a]),m?f.textContent=L:(f.textContent=v,h.classList.add("collapsed"))}f.onclick=()=>this.toggleExpandNode(h,a,f),d.onclick=()=>this.toggleExpandNode(h,a,f),r.appendChild(f),c.appendChild(h)}else c.textContent=String(l);r.appendChild(d),r.appendChild(c),o.appendChild(r)}return t.appendChild(o),t}updateJson(e){let n=H.diff(this.json,e);n&&(H.patch(this.json,n),this.patchDOM(n))}patchDOM(e,n=""){for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;let o=e[t],s=n?`${n}${t}`:t;if(t==="_t")continue;let a=this.parentContainer.querySelector(`.json-property[data-path="${s}"]`);Array.isArray(o)?o.length===2?this.updateValueNode(a,s,this.getValueAtPath(this.json,s)):o.length===3&&o[1]===0&&o[2]===0?a&&a.remove():o.length===1&&this.addPropertyNode(s,o[0]):typeof o=="object"&&this.patchDOM(o,s+"/")}}getValueAtPath(e,n){let t=n.split("/").filter(s=>s),o=e;for(let s of t){if(o==null)return;o=o[s]}return o}updateValueNode(e,n,t){if(!e)return;let o=e.querySelector(".json-value");if(!o)return;if(typeof t=="object"&&t!==null){let a=n.split("/").filter(g=>g).pop()||"",r=n.substring(0,n.lastIndexOf(a));o.innerHTML="",e.classList.add("object");let d=e.querySelector(".json-key"),c=Array.isArray(t);d&&(d.classList.add("clickable"),c?d.textContent=`${a} (${t.length})`:d.textContent=a);let l=e.querySelector(".json-toggle");l||(l=document.createElement("button"),l.classList.add("json-toggle"),e.insertBefore(l,d));let u=this.drawJsonNode(t,n+"/"),p=this.viewStates[n];typeof p<"u"?p?l.textContent=L:(l.textContent=v,u.classList.add("collapsed")):(l.textContent=v,u.classList.add("collapsed")),l.onclick=()=>this.toggleExpandNode(u,n,l),d&&(d.onclick=()=>this.toggleExpandNode(u,n,l)),o.appendChild(u)}else{e.classList.remove("object");let a=e.querySelector(".json-toggle");a&&a.remove(),o.innerHTML="",o.textContent=String(t)}}addPropertyNode(e,n){let t=e.split("/").filter(p=>p),o=t.pop()||"",s=t.join("/"),a;if(s){let p=this.parentContainer.querySelector(`.json-property[data-path="${s}"]`);if(p)a=p.querySelector(".json-properties");else return}else a=this.parentContainer.querySelector(".json-properties");if(!a)return;let r=document.createElement("div");r.classList.add("json-property"),r.setAttribute("data-path",e);let d=document.createElement("span");d.classList.add("json-key"),d.textContent=o+": ";let c=document.createElement("div");c.classList.add("json-value");let l=typeof n=="object"&&n!==null,u=Array.isArray(n);if(l){d.classList.add("clickable"),u?d.textContent=`${o} (${n.length})`:d.textContent=o,r.classList.add("object");let p=document.createElement("button");p.classList.add("json-toggle"),p.textContent=v;let g=this.drawJsonNode(n,e+"/");g.classList.add("collapsed"),p.onclick=()=>this.toggleExpandNode(g,e,p),d.onclick=()=>this.toggleExpandNode(g,e,p),r.appendChild(p),c.appendChild(g)}else c.textContent=String(n);r.appendChild(d),r.appendChild(c),a.appendChild(r)}};function W(i,e={}){i.querySelectorAll(".resize-handle").forEach(b=>b.remove());let{handles:n=["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:t=1/0,maxHeight:o=1/0,minWidth:s=100,minHeight:a=100,onResize:r=()=>{}}=e,d=!1,c=null,l=0,u=0,p=0,g=0,f=0,h=0;function m(b){let x=document.createElement("div");x.classList.add("resize-handle",`resize-${b}`),x.addEventListener("mousedown",j=>y(j,b)),i.appendChild(x)}function y(b,x){d=!0,c=x,l=b.clientX,u=b.clientY,p=i.offsetWidth,g=i.offsetHeight,f=i.offsetLeft,h=i.offsetTop,b.preventDefault(),b.stopPropagation(),document.addEventListener("mousemove",S),document.addEventListener("mouseup",T)}function S(b){if(!d||!c)return;let x=p,j=g,_=f,q=h,R=b.clientX-l,$=b.clientY-u;if(c.includes("right")&&(x=Math.min(Math.max(p+R,s),t)),c.includes("left")){let E=p-R;E>=s&&E<=t&&(x=E,_=f+R)}if(c.includes("bottom")&&(j=Math.min(Math.max(g+$,a),o)),c.includes("top")){let E=g-$;E>=a&&E<=o&&(j=E,q=h+$)}i.style.width=`${x}px`,i.style.height=`${j}px`,i.style.left=`${_}px`,i.style.top=`${q}px`,r(x,j)}function T(){d=!1,c=null,document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",T)}n.forEach(b=>m(b))}function A(i,e,n={}){let t=e||i,o=!1,s=0,a=0,r=0,d=0,{onDragStart:c,onDrag:l,onDragEnd:u}=n;function p(h){let m=h.target;if(m.tagName==="BUTTON"||m.closest("button"))return;o=!0,s=h.clientX,a=h.clientY;let y=getComputedStyle(i);r=parseInt(y.left)||i.offsetLeft,d=parseInt(y.top)||i.offsetTop,y.position!=="absolute"&&y.position!=="fixed"&&(i.style.position="absolute",i.style.left=`${r}px`,i.style.top=`${d}px`),h.preventDefault(),t.style.cursor="grabbing",c&&c(h),document.addEventListener("mousemove",g),document.addEventListener("mouseup",f)}function g(h){if(!o)return;let m=h.clientX-s,y=h.clientY-a,S=r+m,T=d+y;if(l){let b=l(S,T);b&&typeof b=="object"&&(typeof b.x=="number"&&(S=b.x),typeof b.y=="number"&&(T=b.y))}i.style.left=`${S}px`,i.style.top=`${T}px`}function f(){o&&(o=!1,t.style.cursor="grab",u&&u(),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f))}return t.style.cursor="grab",t.addEventListener("mousedown",p),()=>{t.removeEventListener("mousedown",p),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)}}function z(){let i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;return{width:i,height:e}}var N="objects",Z=(d=>(d.TopLeft="topLeft",d.Top="top",d.TopRight="topRight",d.Right="right",d.BottomRight="bottomRight",d.Bottom="bottom",d.BottomLeft="bottomLeft",d.Left="left",d))(Z||{}),ue=280,J=class{constructor(e={}){this.tabEntries={};this.debugStates={};this.activeTab="global";this.resizeThrottleTimer=null;this.options={position:"bottomRight",width:600,height:400,snap:!0,snapPadding:20,...e},this.container=this.createContainer(),this.tabContainer=this.createTabContainer(),this.contentContainer=this.createContentContainer(),this.container.appendChild(this.tabContainer),this.container.appendChild(this.contentContainer),this.toolbar=this.createGlobalToolbar(),this.container.appendChild(this.toolbar),document.body.appendChild(this.container),this.addTab(N),this.addTab("global"),this.restoreSettings(),this.setupResizable(),this.setupDraggable(),this.setupEventListeners(),this.setupKeyboardShortcut(),this.setupWindowResizeListener(),e.show&&!this.loadSettings()&&this.show()}createContainer(){let e=document.createElement("div");return e.classList.add("debug-panel"),e.style.width=`${this.options.width}px`,e.style.height=`${this.options.height}px`,e.style.position="fixed",e.style.opacity="1",e}createTabContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-tabs"),e}createContentContainer(){let e=document.createElement("div");return e.classList.add("debug-panel-content"),e}createGlobalToolbar(){let e=document.createElement("div");e.classList.add("debug-toolbar");let n=document.createElement("span");n.classList.add("debug-keyboard-hint"),n.textContent="Ctrl+Alt+D to hide/show",n.style.color="#999",n.style.fontSize="11px";let t=document.createElement("div");t.classList.add("debug-opacity-container");let o=document.createElement("label");o.classList.add("debug-opacity-label"),o.textContent="O",o.style.fontSize="11px",o.style.color="#999",o.style.marginRight="5px",this.opacitySlider=document.createElement("input"),this.opacitySlider.type="range",this.opacitySlider.min="20",this.opacitySlider.max="100",this.opacitySlider.value="100",this.opacitySlider.classList.add("debug-opacity-slider"),this.opacitySlider.oninput=()=>this.handleOpacityChange(),t.appendChild(this.opacitySlider);let s=document.createElement("button");s.classList.add("debug-clear-button"),s.textContent="Clear",s.onclick=()=>this.clearCurrentTab();let a=document.createElement("button");return a.classList.add("debug-hide-button"),a.textContent="Hide",a.onclick=()=>this.hide(),e.appendChild(n),e.appendChild(t),e.appendChild(s),e.appendChild(a),e}setupEventListeners(){B.addEventListener("log",e=>{let{namespace:n,message:t}=e.target;this.log(n,t)}),B.addEventListener("debug",e=>{let{id:n,state:t}=e.target;if(!n||!t){console.log("Invalid event data for debug-state. Expected {id, state}, got:",e);return}this.debug(n,t)})}setupResizable(){let{width:e,height:n}=z();W(this.container,{handles:["top","left","right","bottom","top-left","top-right","bottom-left","bottom-right"],maxWidth:e-20,maxHeight:n-20,minWidth:200,minHeight:150,onResize:t=>{this.updateToolbarLayout(t),this.saveSettings()}})}setupDraggable(){this.options.snap?A(this.container,this.tabContainer,{onDrag:(e,n)=>this.handleSnapWhileDragging(e,n),onDragEnd:()=>this.saveSettings()}):A(this.container,this.tabContainer,{onDragEnd:()=>this.saveSettings()})}setupPosition(){let{width:e,height:n}=z(),t=this.options.width||600,o=this.options.height||400,s=0,a=0;switch(this.options.position){case"topLeft":s=0,a=0;break;case"top":s=(e-t)/2,a=0;break;case"topRight":s=e-t,a=0;break;case"right":s=e-t,a=(n-o)/2;break;case"bottomRight":s=e-t,a=n-o;break;case"bottom":s=(e-t)/2,a=n-o;break;case"bottomLeft":s=0,a=n-o;break;case"left":s=0,a=(n-o)/2;break}this.container.style.left=`${s}px`,this.container.style.top=`${a}px`}setupKeyboardShortcut(){document.addEventListener("keydown",e=>{e.ctrlKey&&e.altKey&&e.key.toLowerCase()==="d"&&(e.preventDefault(),this.toggle())})}setupWindowResizeListener(){window.addEventListener("resize",()=>{this.resizeThrottleTimer===null&&(this.resizeThrottleTimer=window.setTimeout(()=>{this.resizeThrottleTimer=null,this.repositionOnWindowResize()},50))})}repositionOnWindowResize(){let{width:e,height:n}=z(),t=this.container.offsetWidth,o=this.container.offsetHeight,s=parseInt(this.container.style.left)||this.container.offsetLeft,a=parseInt(this.container.style.top)||this.container.offsetTop,r=s,d=e-(s+t),c=a,l=n-(a+o),u=50,p=r<u,g=d<u,f=c<u,h=l<u,m=s,y=a;g?m=e-t:p?m=0:m=Math.max(0,Math.min(e-t,s)),h?y=n-o:f?y=0:y=Math.max(0,Math.min(n-o,a)),m=Math.max(0,Math.min(e-t,m)),y=Math.max(0,Math.min(n-o,y)),this.container.style.left=`${m}px`,this.container.style.top=`${y}px`,this.saveSettings()}restoreSettings(){let e=this.loadSettings();if(e){this.container.style.left=`${e.left}px`,this.container.style.top=`${e.top}px`,this.container.style.width=`${e.width}px`,this.container.style.height=`${e.height}px`;let n=e.opacity!==void 0?e.opacity:1;this.container.style.opacity=String(n),this.opacitySlider&&(this.opacitySlider.value=String(Math.round(n*100))),e.visible?this.container.classList.add("visible"):this.container.classList.remove("visible")}else this.setupPosition()}loadSettings(){try{let e=localStorage.getItem("debugPanelSettings");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load debug panel settings:",e)}return null}saveSettings(){try{let e=parseFloat(this.container.style.opacity)||1,n={left:parseInt(this.container.style.left)||this.container.offsetLeft,top:parseInt(this.container.style.top)||this.container.offsetTop,width:this.container.offsetWidth,height:this.container.offsetHeight,visible:this.container.classList.contains("visible"),opacity:e};localStorage.setItem("debugPanelSettings",JSON.stringify(n))}catch(e){console.error("Failed to save debug panel settings:",e)}}debug(e,n){let t=e,o=n;!n&&typeof e=="object"&&(t="object",o=e),this.debugStates[t]?this.updateDebugState(t,o):this.addDebugState(t,o)}updateDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${N}"]`);if(!t){console.error("No content for debug namespace.");return}let o=t.querySelector(`#debug-state-${e}`);if(!o){console.error(`No debug state found for ${e}.`);return}let s=o.querySelector(".json-wrapper");if(!s){console.error(`No json wrapper found for existing state ${e}`);return}s.innerHTML="",this.debugStates[e].state=n,this.debugStates[e].jsonView.updateJson(n)}addDebugState(e,n){let t=this.contentContainer.querySelector(`[data-namespace="${N}"]`);if(!t){console.error("No content for debug namespace.");return}let o=document.createElement("div");o.classList.add("debug-state"),o.setAttribute("id",`debug-state-${e}`);let s=()=>{let g=this.debugStates[e].isExpanded;this.debugStates[e].isExpanded=!g,o.classList.toggle("collapsed",g),a.textContent=g?v:L},a=document.createElement("button");a.classList.add("json-toggle"),a.textContent=L,a.onclick=s,o.appendChild(a);let r=document.createElement("div");r.classList.add("debug-state-label"),r.innerText=e||"untitled",r.onclick=s,o.appendChild(r);let d=document.createElement("div");d.classList.add("json-wrapper"),o.appendChild(d);let c=new M(n,d,{}),l=document.createElement("div");l.classList.add("debug-state-hover-actions");let u=document.createElement("button");u.classList.add("debug-state-action-button","debug-state-copy-button"),u.innerHTML="\u{1F4CB}",u.title="Copy JSON to clipboard",u.onclick=()=>this.copyDebugStateToClipboard(e,n,u),l.appendChild(u);let p=document.createElement("button");p.classList.add("debug-state-action-button","debug-state-delete-button"),p.innerHTML="\u{1F5D1}\uFE0F",p.title="Delete this object",p.onclick=()=>this.removeDebugState(e),l.appendChild(p),d.appendChild(l),this.debugStates[e]={state:n,jsonView:c,isExpanded:!0},t.appendChild(o)}copyDebugStateToClipboard(e,n,t){try{let o=JSON.stringify(n,null,2);navigator.clipboard.writeText(o).then(()=>{let s=t.innerHTML;t.innerHTML="\u2713",t.style.background="rgba(40, 167, 69, 0.8)",setTimeout(()=>{t.innerHTML=s,t.style.background=""},2e3)}).catch(s=>{console.error("Failed to copy to clipboard:",s)})}catch(o){console.error("Failed to stringify state:",o)}}removeDebugState(e){let n=document.getElementById(`debug-state-${e}`);n&&n.remove(),delete this.debugStates[e]}addTab(e){if(this.tabEntries[e])return;this.tabEntries[e]=[];let n=document.createElement("button");n.classList.add("debug-tab"),n.textContent=e,n.onclick=()=>this.switchTab(e),this.tabContainer.appendChild(n);let t=document.createElement("div");t.classList.add("debug-tab-content"),t.dataset.namespace=e,this.contentContainer.appendChild(t),Object.keys(this.tabEntries).length===1&&this.switchTab(e)}clearCurrentTab(){this.clearTab(this.activeTab)}clearTab(e){let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(this.tabEntries[e]=[],e===N&&Object.keys(this.debugStates).forEach(t=>{delete this.debugStates[t]}),n.innerHTML="")}switchTab(e){this.activeTab=e,this.tabContainer.querySelectorAll(".debug-tab").forEach((t,o)=>{let s=Object.keys(this.tabEntries)[o];t.classList.toggle("active",s===e)}),this.contentContainer.querySelectorAll(".debug-tab-content").forEach(t=>{t.style.display="none"});let n=this.contentContainer.querySelector(`[data-namespace="${e}"]`);n&&(n.style.display="block")}log(e,n){this.tabEntries[e]||this.addTab(e);let t={id:`${e}-${Date.now()}-${Math.random()}`,message:n,timestamp:new Date};this.tabEntries[e].push(t);let o=this.contentContainer.querySelector(`[data-namespace="${e}"]`);if(!o)return;let s=this.createLogElement(t,e);o.appendChild(s),e!=="global"&&this.log("global",n)}createLogElement(e,n){let t=document.createElement("div");t.classList.add("debug-log-entry"),t.dataset.logId=e.id;let o=document.createElement("div");o.innerText=`[${e.timestamp.toLocaleTimeString()}] ${this.renderLogEntry(e.message)}`,o.classList.add("debug-log-entry-text");let s=document.createElement("button");s.innerText="\u{1F4CB}",s.classList.add("debug-copy-button"),s.onclick=()=>navigator.clipboard.writeText(o.innerText);let a=document.createElement("button");return a.innerText="\u274C",a.classList.add("debug-delete-button"),a.onclick=()=>this.removeLogEntry(n,e.id,t),t.appendChild(o),t.appendChild(s),t.appendChild(a),t}removeLogEntry(e,n,t){this.tabEntries[e]=this.tabEntries[e].filter(o=>o.id!==n),t.remove()}renderLogEntry(e){return Array.isArray(e)?e.join(" "):typeof e=="object"?(0,Q.default)(e):String(e)}updateToolbarLayout(e){e<ue?this.container.classList.add("narrow-panel"):this.container.classList.remove("narrow-panel")}handleOpacityChange(){let n=parseInt(this.opacitySlider.value)/100;this.container.classList.contains("visible")&&(this.container.style.opacity=String(n)),this.saveSettings()}handleSnapWhileDragging(e,n){let t=this.options.snapPadding||20,{width:o,height:s}=z(),a=this.container.offsetWidth,r=this.container.offsetHeight,d=e,c=n;return e<t?d=0:e+a>o-t&&(d=o-a),n<t?c=0:n+r>s-t&&(c=s-r),{x:d,y:c}}show(){this.container.classList.add("visible");let e=parseFloat(this.container.style.opacity)||1;this.container.style.opacity=String(e),this.saveSettings()}hide(){this.container.classList.remove("visible"),this.saveSettings()}toggle(){this.container.classList.contains("visible")?this.hide():this.show()}};function ge(i,e){B.dispatch("debug",{id:i,state:e})}export{J as DebugPanel,M as JsonView,Z as ScreenPosition,ge as debug,z as getWindowSize,A as makeDraggable,W as makeResizable};
//# sourceMappingURL=index.esm.js.map
