{"version":3,"sources":["../src/DebugPanel/DebugPanel.scss","../src/JsonView/JsonView.scss","../src/DebugPanel/DebugPanel.ts","../src/constants.ts","../src/JsonView/JsonView.ts","../src/utils/domUtils.ts"],"sourcesContent":["\nconst css = \".debug-panel{position:fixed;z-index:99999;background:#222;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;font-family:Arial,sans-serif;color:#fff;transition:transform .2s ease-in-out,visibility .2s ease-in-out}.debug-panel.visible{visibility:visible;transform:translateY(0)}.debug-panel:not(.visible){visibility:hidden;transform:translateY(10px);pointer-events:none}.debug-panel .debug-panel-tabs{display:flex;flex-wrap:wrap;background:#1a1a1a;padding:6px 6px 0 6px;gap:3px;cursor:grab;user-select:none}.debug-panel .debug-panel-tabs:active{cursor:grabbing}.debug-panel .debug-panel-tabs .debug-tab{background:#2d2d2d;color:#888;padding:7px 8px;margin:0;border:none;border-top-left-radius:6px;border-top-right-radius:6px;cursor:pointer;position:relative;box-shadow:inset 0 -2px 4px rgba(0,0,0,.3);font-family:system-ui,-apple-system,BlinkMacSystemFont,\\\"Segoe UI\\\",Roboto,Oxygen,Ubuntu,Cantarell,\\\"Open Sans\\\",\\\"Helvetica Neue\\\",sans-serif}.debug-panel .debug-panel-tabs .debug-tab:hover{background:#353535;color:#aaa}.debug-panel .debug-panel-tabs .debug-tab:focus{outline:none}.debug-panel .debug-panel-tabs .debug-tab.active{background:linear-gradient(to bottom, #3f6d9c, #24384d);color:#fff;box-shadow:0 -3px 8px rgba(0,102,204,.4),inset 0 1px 0 hsla(0,0%,100%,.2);z-index:1}.debug-panel .debug-panel-content{flex:1;display:flex;flex-direction:column;overflow-y:auto;padding:0px 15px;background:#0d0d0d}.debug-panel .debug-panel-content .debug-tab-content{display:none;flex-direction:column;flex:1;gap:5px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry{background:#292929;color:#ddd;padding:5px 8px;border-radius:4px;font-size:12px;word-break:break-word;border-left:3px solid #007bff;position:relative;display:flex;align-items:center}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry:hover .debug-copy-button{opacity:1}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-log-entry-text{flex:1;padding-right:70px}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{position:absolute;top:50%;transform:translateY(-50%);background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:12px;font-weight:bold;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out,background .2s ease-in-out}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-action-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover,.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#969696}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button{right:36px;background:rgba(85,170,255,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-copy-button:hover{background:#28f}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button{right:8px;background:rgba(223,161,152,.8)}.debug-panel .debug-panel-content .debug-tab-content .debug-log-entry .debug-delete-button:hover{background:#f22}.debug-panel .debug-toolbar{display:flex;box-sizing:border-box;width:100%;align-items:center;justify-content:flex-end;gap:2px;padding:8px;background:#111;border-top:1px solid hsla(0,0%,100%,.1);flex-wrap:wrap}.debug-panel .debug-toolbar .debug-keyboard-hint{margin-right:auto;color:#999;font-size:11px;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container{display:flex;align-items:center;gap:0px;max-width:100px;min-width:40px;flex-shrink:1;padding:4px 0}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-label{font-size:11px;color:#999;white-space:nowrap}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider{flex:1;min-width:40px;width:100%;max-width:100%;height:4px;background:#444;border-radius:2px;outline:none;-webkit-appearance:none;appearance:none}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb{width:14px;height:14px;background:#007bff;cursor:pointer;border-radius:50%;border:none;position:relative;top:-4px;transition:background .2s}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-thumb:hover{background:#0056b3}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-webkit-slider-runnable-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar .debug-opacity-container .debug-opacity-slider::-moz-range-track{height:4px;background:#444;border-radius:2px}.debug-panel .debug-toolbar button{background:#ba6c38;color:#fff;border:none;padding:5px 10px;margin:2px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s;white-space:nowrap;flex-shrink:0}.debug-panel .debug-toolbar button:hover{background:#c9302c}.debug-panel .debug-toolbar button:focus{outline:none}.debug-panel .debug-toolbar{container-type:inline-size}@container (max-width: 350px){.debug-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel .debug-toolbar .debug-keyboard-hint{display:none}.debug-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}}.debug-panel.narrow-panel .debug-toolbar{flex-direction:column;align-items:stretch}.debug-panel.narrow-panel .debug-toolbar .debug-keyboard-hint{margin-right:0;text-align:center}.debug-panel.narrow-panel .debug-toolbar .debug-opacity-container{max-width:100%;justify-content:center}.debug-panel .resize-handle{position:absolute;background:hsla(0,0%,100%,.1);z-index:10;transition:background .2s}.debug-panel .resize-handle:hover{background:hsla(0,0%,100%,.3)}.debug-panel .resize-left,.debug-panel .resize-right{top:0;bottom:0;width:6px;cursor:ew-resize}.debug-panel .resize-left{left:-3px}.debug-panel .resize-right{right:-3px}.debug-panel .resize-top,.debug-panel .resize-bottom{left:0;right:0;height:6px;cursor:ns-resize}.debug-panel .resize-top{top:-3px}.debug-panel .resize-bottom{bottom:-3px}.debug-panel .resize-top-left,.debug-panel .resize-top-right,.debug-panel .resize-bottom-left,.debug-panel .resize-bottom-right{width:10px;height:10px}.debug-panel .resize-top-left{left:-3px;top:-3px;cursor:nwse-resize}.debug-panel .resize-top-right{right:-3px;top:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-left{left:-3px;bottom:-3px;cursor:nesw-resize}.debug-panel .resize-bottom-right{right:-3px;bottom:-3px;cursor:nwse-resize}.debug-state{position:relative;flex:1 0 100%;display:flex;flex-direction:column;margin-bottom:5px;margin-left:10px}.debug-state .json-toggle{position:absolute;top:2px;left:-22px;margin:0 10px 0 0;border:none;background:none;cursor:pointer;color:#888;font-size:14px;padding:0;width:20px;height:20px;transition:color .2s}.debug-state .json-toggle:hover{color:#fff}.debug-state .json-toggle:focus{outline:none}.debug-state .debug-state-label{font-size:13px;font-weight:bold;padding:5px 0;color:#ccc}.debug-state .debug-state-label:hover{color:#fff;cursor:pointer;text-decoration:underline}.debug-state .json-wrapper{position:relative;padding:5px;margin-left:-15px;background:#292929;border-radius:4px;border-left:3px solid #28a745}.debug-state .json-wrapper .debug-state-hover-actions{position:absolute;top:4px;right:4px;display:flex;gap:6px;opacity:0;transition:opacity .2s ease-in-out;z-index:10}.debug-state .json-wrapper:hover .debug-state-hover-actions{opacity:1}.debug-state .json-wrapper .debug-state-action-button{background:rgba(100,100,100,.8);color:#fff;border:none;cursor:pointer;font-size:16px;width:28px;height:28px;border-radius:4px;display:flex;align-items:center;justify-content:center;padding:0;transition:background .2s ease-in-out,transform .1s ease-in-out}.debug-state .json-wrapper .debug-state-action-button:hover{transform:scale(1.1)}.debug-state .json-wrapper .debug-state-action-button:active{transform:scale(0.95)}.debug-state .json-wrapper .debug-state-action-button:focus{outline:none}.debug-state .json-wrapper .debug-state-copy-button{background:rgba(85,170,255,.8)}.debug-state .json-wrapper .debug-state-copy-button:hover{background:#28f}.debug-state .json-wrapper .debug-state-delete-button{background:rgba(255,85,85,.8)}.debug-state .json-wrapper .debug-state-delete-button:hover{background:#f22}.debug-state.collapsed .json-wrapper{display:none}\";\nif (typeof document !== 'undefined') {\n  const style = document.createElement('style');\n  style.textContent = css;\n  document.head.appendChild(style);\n}\nexport default css;\n","\nconst css = \".json-node{position:relative;margin-left:20px;padding-left:0;font-size:12px;line-height:1.2em}.json-node .json-properties{display:flex;flex-direction:column}.json-node .json-property{position:relative;display:flex;align-items:flex-start;padding:2px 0}.json-node .json-property.object{flex-direction:column}.json-node .json-key{font-weight:bold;margin-right:5px;color:#9cdcfe}.json-node .json-key.clickable{cursor:pointer}.json-node .json-key.clickable:hover{color:#4fc3f7;text-decoration:underline}.json-node .json-value{color:#ce9178;white-space:pre-wrap;word-break:break-word;flex:1}.json-node .json-toggle{position:absolute;top:0px;left:-22px;border:none;background:none;cursor:pointer;color:#888;font-size:12px;padding:0;width:20px;height:20px;transition:color .2s}.json-node .json-toggle:hover{color:#fff}.json-node .json-toggle:focus{outline:none}.json-node .collapsed .json-properties{display:none}\";\nif (typeof document !== 'undefined') {\n  const style = document.createElement('style');\n  style.textContent = css;\n  document.head.appendChild(style);\n}\nexport default css;\n","import EventBus from 'eventbusjs';\nimport safeStringify from 'fast-safe-stringify';\nimport { COLLAPSED_INDICATOR, EXPANDED_INDICATOR } from '../constants';\nimport { JsonView } from '../JsonView/JsonView';\nimport { getWindowSize, makeDraggable, makeResizable } from '../utils/domUtils';\n\nconst DEBUG_STATE_NAMESPACE = 'objects';\n\nexport enum ScreenPosition {\n\tTopLeft = 'topLeft',\n\tTop = 'top',\n\tTopRight = 'topRight',\n\tRight = 'right',\n\tBottomRight = 'bottomRight',\n\tBottom = 'bottom',\n\tBottomLeft = 'bottomLeft',\n\tLeft = 'left'\n}\n\nconst MIN_WIDTH = 280;\n\ntype LogEntry = {\n\tid: string;\n\tmessage: Array<any> | object | string;\n\ttimestamp: Date;\n};\n\ntype LogEvent = {\n\tnamespace: string;\n\targs: Array<any>;\n};\n\ninterface TabEntries {\n\t[namespace: string]: LogEntry[];\n}\n\ninterface DebugState {\n\tstate: any;\n\tjsonView: JsonView;\n\tisExpanded: boolean;\n}\n\nexport interface DebugPanelSettings {\n\tleft: number;\n\ttop: number;\n\twidth: number;\n\theight: number;\n\tvisible: boolean;\n\topacity: number;\n}\n\nexport interface DebugPanelOptions {\n\tshow?: boolean;\n\tposition?: ScreenPosition;\n\twidth?: number;\n\theight?: number;\n\tsnap?: boolean;\n\tsnapPadding?: number;\n}\n\n/*\nDebugPanel usage API:\n\ndebug(obj), debug(id, obj)\nlog(...args)\nshow()\nhide()\ntoggle()\n\n*/\n\nexport class DebugPanel {\n\tprivate container: HTMLElement;\n\tprivate tabContainer: HTMLElement;\n\tprivate contentContainer: HTMLElement;\n\tprivate toolbar: HTMLElement;\n\tprivate opacitySlider!: HTMLInputElement;\n\tprivate tabEntries: TabEntries = {};\n\tprivate debugStates: { [id: string]: DebugState } = {};\n\tprivate activeTab: string = 'global';\n\tprivate options: DebugPanelOptions;\n\tprivate resizeThrottleTimer: number | null = null;\n\n\tconstructor(options: DebugPanelOptions = {}) {\n\t\tthis.options = {\n\t\t\tposition: ScreenPosition.BottomRight,\n\t\t\twidth: 600,\n\t\t\theight: 400,\n\t\t\tsnap: true,\n\t\t\tsnapPadding: 20,\n\t\t\t...options\n\t\t};\n\n\t\tthis.container = this.createContainer();\n\t\tthis.tabContainer = this.createTabContainer();\n\t\tthis.contentContainer = this.createContentContainer();\n\n\t\tthis.container.appendChild(this.tabContainer);\n\t\tthis.container.appendChild(this.contentContainer);\n\n\t\tthis.toolbar = this.createGlobalToolbar();\n\t\tthis.container.appendChild(this.toolbar);\n\n\t\tdocument.body.appendChild(this.container);\n\n\t\tthis.addTab(DEBUG_STATE_NAMESPACE);\n\t\tthis.addTab('global');\n\n\t\t// Restore settings first (including visibility) before setting up interactions\n\t\tthis.restoreSettings();\n\t\tthis.setupResizable();\n\t\tthis.setupDraggable();\n\t\tthis.setupEventListeners();\n\t\tthis.setupKeyboardShortcut();\n\t\tthis.setupWindowResizeListener();\n\n\t\t// Only show if explicitly requested in options AND no saved settings exist\n\t\tif (options.show && !this.loadSettings()) {\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tprivate createContainer(): HTMLElement {\n\t\tconst container = document.createElement('div');\n\t\tcontainer.classList.add('debug-panel');\n\t\tcontainer.style.width = `${this.options.width}px`;\n\t\tcontainer.style.height = `${this.options.height}px`;\n\t\tcontainer.style.position = 'fixed';\n\t\tcontainer.style.opacity = '1'; // Set default opacity\n\t\treturn container;\n\t}\n\n\tprivate createTabContainer(): HTMLElement {\n\t\tconst tabContainer = document.createElement('div');\n\t\ttabContainer.classList.add('debug-panel-tabs');\n\t\treturn tabContainer;\n\t}\n\n\tprivate createContentContainer(): HTMLElement {\n\t\tconst contentContainer = document.createElement('div');\n\t\tcontentContainer.classList.add('debug-panel-content');\n\t\treturn contentContainer;\n\t}\n\n\tprivate createGlobalToolbar(): HTMLElement {\n\t\tconst toolbar = document.createElement('div');\n\t\ttoolbar.classList.add('debug-toolbar');\n\n\t\tconst hint = document.createElement('span');\n\t\thint.classList.add('debug-keyboard-hint');\n\t\thint.textContent = 'Ctrl+Alt+D to hide/show';\n\t\thint.style.color = '#999';\n\t\thint.style.fontSize = '11px';\n\n\t\tconst opacityContainer = document.createElement('div');\n\t\topacityContainer.classList.add('debug-opacity-container');\n\n\t\tconst opacityLabel = document.createElement('label');\n\t\topacityLabel.classList.add('debug-opacity-label');\n\t\topacityLabel.textContent = 'O';\n\t\topacityLabel.style.fontSize = '11px';\n\t\topacityLabel.style.color = '#999';\n\t\topacityLabel.style.marginRight = '5px';\n\n\t\tthis.opacitySlider = document.createElement('input');\n\t\tthis.opacitySlider.type = 'range';\n\t\tthis.opacitySlider.min = '20';\n\t\tthis.opacitySlider.max = '100';\n\t\tthis.opacitySlider.value = '100';\n\t\tthis.opacitySlider.classList.add('debug-opacity-slider');\n\t\tthis.opacitySlider.oninput = () => this.handleOpacityChange();\n\n\t\t//opacityContainer.appendChild(opacityLabel);\n\t\topacityContainer.appendChild(this.opacitySlider);\n\n\t\tconst clearButton = document.createElement('button');\n\t\tclearButton.classList.add('debug-clear-button');\n\t\tclearButton.textContent = 'Clear';\n\t\tclearButton.onclick = () => this.clearCurrentTab();\n\n\t\tconst hideButton = document.createElement('button');\n\t\thideButton.classList.add('debug-hide-button');\n\t\thideButton.textContent = 'Hide';\n\t\thideButton.onclick = () => this.hide();\n\n\t\ttoolbar.appendChild(hint);\n\t\ttoolbar.appendChild(opacityContainer);\n\t\ttoolbar.appendChild(clearButton);\n\t\ttoolbar.appendChild(hideButton);\n\n\t\treturn toolbar;\n\t}\n\n\tprivate setupEventListeners(): void {\n\t\tEventBus.addEventListener('log', (event: any) => {\n\t\t\tconst { namespace, message } = event.target;\n\t\t\tthis.log(namespace, message);\n\t\t});\n\n\t\t// special listener for sending objects to the objects panel\n\t\t// todo:\n\t\tEventBus.addEventListener('debug', (event: any) => {\n\t\t\tconst { id, state } = event.target;\n\t\t\t// if (!id || !state) {\n\t\t\t// \tconsole.log('Invalid event data for debug-state. Expected {id, state}, got:', event);\n\t\t\t// \treturn;\n\t\t\t// }\n\t\t\tthis.debug(id, state);\n\t\t});\n\t}\n\n\tprivate setupResizable(): void {\n\t\tconst { width, height } = getWindowSize();\n\n\t\tmakeResizable(this.container, {\n\t\t\thandles: ['top', 'left', 'right', 'bottom', 'top-left', 'top-right', 'bottom-left', 'bottom-right'],\n\t\t\tmaxWidth: width - 20,\n\t\t\tmaxHeight: height - 20,\n\t\t\tminWidth: 200,\n\t\t\tminHeight: 150,\n\t\t\tonResize: (newWidth: number) => {\n\t\t\t\tthis.updateToolbarLayout(newWidth);\n\t\t\t\tthis.saveSettings();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate setupDraggable(): void {\n\t\tif (this.options.snap) {\n\t\t\tmakeDraggable(this.container, this.tabContainer, {\n\t\t\t\tonDrag: (x: number, y: number) => this.handleSnapWhileDragging(x, y),\n\t\t\t\tonDragEnd: () => this.saveSettings()\n\t\t\t});\n\t\t} else {\n\t\t\tmakeDraggable(this.container, this.tabContainer, {\n\t\t\t\tonDragEnd: () => this.saveSettings()\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate setupPosition(): void {\n\t\tconst { width, height } = getWindowSize();\n\t\tconst panelWidth = this.options.width || 600;\n\t\tconst panelHeight = this.options.height || 400;\n\n\t\tlet left = 0;\n\t\tlet top = 0;\n\n\t\tswitch (this.options.position) {\n\t\t\tcase ScreenPosition.TopLeft:\n\t\t\t\tleft = 0;\n\t\t\t\ttop = 0;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.Top:\n\t\t\t\tleft = (width - panelWidth) / 2;\n\t\t\t\ttop = 0;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.TopRight:\n\t\t\t\tleft = width - panelWidth;\n\t\t\t\ttop = 0;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.Right:\n\t\t\t\tleft = width - panelWidth;\n\t\t\t\ttop = (height - panelHeight) / 2;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.BottomRight:\n\t\t\t\tleft = width - panelWidth;\n\t\t\t\ttop = height - panelHeight;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.Bottom:\n\t\t\t\tleft = (width - panelWidth) / 2;\n\t\t\t\ttop = height - panelHeight;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.BottomLeft:\n\t\t\t\tleft = 0;\n\t\t\t\ttop = height - panelHeight;\n\t\t\t\tbreak;\n\t\t\tcase ScreenPosition.Left:\n\t\t\t\tleft = 0;\n\t\t\t\ttop = (height - panelHeight) / 2;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.container.style.left = `${left}px`;\n\t\tthis.container.style.top = `${top}px`;\n\t}\n\n\tprivate setupKeyboardShortcut(): void {\n\t\tdocument.addEventListener('keydown', (event: KeyboardEvent) => {\n\t\t\t// Check for Ctrl+Alt+D\n\t\t\tif (event.ctrlKey && event.altKey && event.key.toLowerCase() === 'd') {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.toggle();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate setupWindowResizeListener(): void {\n\t\twindow.addEventListener('resize', () => {\n\t\t\t// Throttle resize events to 50ms\n\t\t\tif (this.resizeThrottleTimer !== null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.resizeThrottleTimer = window.setTimeout(() => {\n\t\t\t\tthis.resizeThrottleTimer = null;\n\t\t\t\tthis.repositionOnWindowResize();\n\t\t\t}, 50);\n\t\t});\n\t}\n\n\tprivate repositionOnWindowResize(): void {\n\t\tconst { width: windowWidth, height: windowHeight } = getWindowSize();\n\t\tconst panelWidth = this.container.offsetWidth;\n\t\tconst panelHeight = this.container.offsetHeight;\n\n\t\tconst currentLeft = parseInt(this.container.style.left) || this.container.offsetLeft;\n\t\tconst currentTop = parseInt(this.container.style.top) || this.container.offsetTop;\n\n\t\t// Calculate distances to each edge\n\t\tconst distanceToLeft = currentLeft;\n\t\tconst distanceToRight = windowWidth - (currentLeft + panelWidth);\n\t\tconst distanceToTop = currentTop;\n\t\tconst distanceToBottom = windowHeight - (currentTop + panelHeight);\n\n\t\t// Determine which edges the panel was snapped to before resize\n\t\tconst snapThreshold = 50; // If within 50px of an edge, consider it \"snapped\"\n\t\tconst wasSnappedLeft = distanceToLeft < snapThreshold;\n\t\tconst wasSnappedRight = distanceToRight < snapThreshold;\n\t\tconst wasSnappedTop = distanceToTop < snapThreshold;\n\t\tconst wasSnappedBottom = distanceToBottom < snapThreshold;\n\n\t\tlet newLeft = currentLeft;\n\t\tlet newTop = currentTop;\n\n\t\t// Snap to the edge(s) the panel was closest to\n\t\tif (wasSnappedRight) {\n\t\t\t// Keep panel snapped to right edge\n\t\t\tnewLeft = windowWidth - panelWidth;\n\t\t} else if (wasSnappedLeft) {\n\t\t\t// Keep panel snapped to left edge\n\t\t\tnewLeft = 0;\n\t\t} else {\n\t\t\t// Not snapped horizontally, ensure it stays in bounds\n\t\t\tnewLeft = Math.max(0, Math.min(windowWidth - panelWidth, currentLeft));\n\t\t}\n\n\t\tif (wasSnappedBottom) {\n\t\t\t// Keep panel snapped to bottom edge\n\t\t\tnewTop = windowHeight - panelHeight;\n\t\t} else if (wasSnappedTop) {\n\t\t\t// Keep panel snapped to top edge\n\t\t\tnewTop = 0;\n\t\t} else {\n\t\t\t// Not snapped vertically, ensure it stays in bounds\n\t\t\tnewTop = Math.max(0, Math.min(windowHeight - panelHeight, currentTop));\n\t\t}\n\n\t\t// Final bounds check to ensure panel is fully visible\n\t\tnewLeft = Math.max(0, Math.min(windowWidth - panelWidth, newLeft));\n\t\tnewTop = Math.max(0, Math.min(windowHeight - panelHeight, newTop));\n\n\t\tthis.container.style.left = `${newLeft}px`;\n\t\tthis.container.style.top = `${newTop}px`;\n\n\t\tthis.saveSettings();\n\t}\n\n\t// Settings management\n\n\tprivate restoreSettings(): void {\n\t\tconst savedSettings = this.loadSettings();\n\n\t\tif (savedSettings) {\n\t\t\t// Restore saved position and size\n\t\t\tthis.container.style.left = `${savedSettings.left}px`;\n\t\t\tthis.container.style.top = `${savedSettings.top}px`;\n\t\t\tthis.container.style.width = `${savedSettings.width}px`;\n\t\t\tthis.container.style.height = `${savedSettings.height}px`;\n\n\t\t\t// Restore opacity\n\t\t\tconst opacity = savedSettings.opacity !== undefined ? savedSettings.opacity : 1;\n\t\t\tthis.container.style.opacity = String(opacity);\n\t\t\tif (this.opacitySlider) {\n\t\t\t\tthis.opacitySlider.value = String(Math.round(opacity * 100));\n\t\t\t}\n\n\t\t\t// Restore visibility state without triggering saveSettings\n\t\t\tif (savedSettings.visible) {\n\t\t\t\tthis.container.classList.add('visible');\n\t\t\t} else {\n\t\t\t\tthis.container.classList.remove('visible');\n\t\t\t}\n\t\t} else {\n\t\t\t// Use default position if no saved settings\n\t\t\tthis.setupPosition();\n\t\t\t// Don't set visibility - let the constructor handle it\n\t\t}\n\t}\n\n\tprivate loadSettings(): DebugPanelSettings | null {\n\t\ttry {\n\t\t\tconst settingsJson = localStorage.getItem('debugPanelSettings');\n\t\t\tif (settingsJson) {\n\t\t\t\treturn JSON.parse(settingsJson);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load debug panel settings:', error);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate saveSettings(): void {\n\t\ttry {\n\t\t\tconst opacity = parseFloat(this.container.style.opacity) || 1;\n\t\t\tconst settings: DebugPanelSettings = {\n\t\t\t\tleft: parseInt(this.container.style.left) || this.container.offsetLeft,\n\t\t\t\ttop: parseInt(this.container.style.top) || this.container.offsetTop,\n\t\t\t\twidth: this.container.offsetWidth,\n\t\t\t\theight: this.container.offsetHeight,\n\t\t\t\tvisible: this.container.classList.contains('visible'),\n\t\t\t\topacity: opacity\n\t\t\t};\n\t\t\tlocalStorage.setItem('debugPanelSettings', JSON.stringify(settings));\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to save debug panel settings:', error);\n\t\t}\n\t}\n\n\t// Debug objects\n\n\t// Send any object to the DebugPanel for observation. Use a string id as first argument to label it.\n\tpublic debug(idOrState: any, state?: any): void {\n\t\t//if (typeof idOrState === 'string')\n\t\tlet _id = idOrState;\n\t\tlet _state = state;\n\t\tif (!state && typeof idOrState == 'object') {\n\t\t\t_id = 'object'; // todo: make object IDs?\n\t\t\t_state = idOrState;\n\t\t}\n\n\t\t// todo: this is not efficient, but is how to deal with circular dependencies.\n\t\t// const safeState = safeStringify(_state);\n\t\t// const parsedState = JSON.parse(safeState);\n\n\t\tif (this.debugStates[_id]) {\n\t\t\tthis.updateDebugState(_id, _state); // parsedState);\n\t\t} else {\n\t\t\tthis.addDebugState(_id, _state);// parsedState);\n\t\t}\n\t}\n\n\tprivate updateDebugState(id: string, state: any): void {\n\t\tconst content = this.contentContainer.querySelector(`[data-namespace=\"${DEBUG_STATE_NAMESPACE}\"]`);\n\t\tif (!content) {\n\t\t\tconsole.error('No content for debug namespace.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst debugWrapper: HTMLElement | null = content.querySelector(`#debug-state-${id}`);\n\t\tif (!debugWrapper) {\n\t\t\tconsole.error(`No debug state found for ${id}.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst jsonWrapper = debugWrapper.querySelector('.json-wrapper');\n\t\tif (!jsonWrapper) {\n\t\t\tconsole.error(`No json wrapper found for existing state ${id}`);\n\t\t\treturn;\n\t\t}\n\n\t\t// Clone the state to avoid reference issues when comparing\n\t\tconst clonedState = JSON.parse(JSON.stringify(state));\n\n\t\t// Don't clear innerHTML - JsonView.updateJson needs the existing DOM to patch\n\t\tthis.debugStates[id].jsonView.updateJson(clonedState);\n\t\tthis.debugStates[id].state = clonedState;\n\t}\n\n\tprivate addDebugState(id: string, state: any): void {\n\t\tconst content = this.contentContainer.querySelector(`[data-namespace=\"${DEBUG_STATE_NAMESPACE}\"]`);\n\t\tif (!content) {\n\t\t\tconsole.error('No content for debug namespace.');\n\t\t\treturn;\n\t\t}\n\n\t\t// Clone the state to avoid reference issues\n\t\tconst clonedState = JSON.parse(JSON.stringify(state));\n\n\t\tconst debugWrapper = document.createElement('div');\n\t\tdebugWrapper.classList.add('debug-state');\n\t\tdebugWrapper.setAttribute('id', `debug-state-${id}`);\n\n\t\tconst toggleObjectOpen = () => {\n\t\t\tconst isExpanded = this.debugStates[id].isExpanded;\n\t\t\tthis.debugStates[id].isExpanded = !isExpanded;\n\t\t\tdebugWrapper.classList.toggle('collapsed', isExpanded);\n\t\t\ttoggleButton.textContent = isExpanded ? COLLAPSED_INDICATOR : EXPANDED_INDICATOR;\n\t\t}\n\n\t\tconst toggleButton = document.createElement('button');\n\t\ttoggleButton.classList.add('json-toggle');\n\t\ttoggleButton.textContent = EXPANDED_INDICATOR;\n\t\ttoggleButton.onclick = toggleObjectOpen;\n\t\tdebugWrapper.appendChild(toggleButton);\n\n\t\tconst label = document.createElement('div');\n\t\tlabel.classList.add('debug-state-label');\n\t\tlabel.innerText = id || 'untitled';\n\t\tlabel.onclick = toggleObjectOpen;\n\t\tdebugWrapper.appendChild(label);\n\n\t\tconst jsonWrapper = document.createElement('div');\n\t\tjsonWrapper.classList.add('json-wrapper');\n\t\tdebugWrapper.appendChild(jsonWrapper);\n\n\t\t// Create JsonView first (it will render and may clear the container)\n\t\tconst jsonView = new JsonView(clonedState, jsonWrapper as HTMLElement, {\n\t\t\t//expandObjs: [/children/, /children\\/(.*)/, /entry/]\n\t\t});\n\n\t\t// Add hover actions AFTER JsonView has rendered (so they don't get cleared)\n\t\tconst hoverActions = document.createElement('div');\n\t\thoverActions.classList.add('debug-state-hover-actions');\n\n\t\t// Copy button\n\t\tconst copyButton = document.createElement('button');\n\t\tcopyButton.classList.add('debug-state-action-button', 'debug-state-copy-button');\n\t\tcopyButton.innerHTML = '📋';\n\t\tcopyButton.title = 'Copy JSON to clipboard';\n\t\tcopyButton.onclick = () => this.copyDebugStateToClipboard(id, this.debugStates[id].state, copyButton);\n\t\thoverActions.appendChild(copyButton);\n\n\t\t// Delete button\n\t\tconst deleteButton = document.createElement('button');\n\t\tdeleteButton.classList.add('debug-state-action-button', 'debug-state-delete-button');\n\t\tdeleteButton.innerHTML = '🗑️';\n\t\tdeleteButton.title = 'Delete this object';\n\t\tdeleteButton.onclick = () => this.removeDebugState(id);\n\t\thoverActions.appendChild(deleteButton);\n\n\t\tjsonWrapper.appendChild(hoverActions);\n\n\t\tthis.debugStates[id] = {\n\t\t\tstate: clonedState,\n\t\t\tjsonView,\n\t\t\tisExpanded: true\n\t\t};\n\n\t\tcontent.appendChild(debugWrapper);\n\t}\n\n\tprivate copyDebugStateToClipboard(id: string, state: any, button: HTMLElement): void {\n\t\ttry {\n\t\t\tconst jsonString = JSON.stringify(state, null, 2);\n\t\t\tnavigator.clipboard.writeText(jsonString).then(() => {\n\t\t\t\t// Change icon to checkmark\n\t\t\t\tconst originalContent = button.innerHTML;\n\t\t\t\tbutton.innerHTML = '✓';\n\t\t\t\tbutton.style.background = 'rgba(40, 167, 69, 0.8)';\n\n\t\t\t\t// Revert after 2 seconds\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tbutton.innerHTML = originalContent;\n\t\t\t\t\tbutton.style.background = '';\n\t\t\t\t}, 2000);\n\t\t\t}).catch((err) => {\n\t\t\t\tconsole.error('Failed to copy to clipboard:', err);\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to stringify state:', error);\n\t\t}\n\t}\n\n\tprivate removeDebugState(id: string): void {\n\t\tconst debugWrapper = document.getElementById(`debug-state-${id}`);\n\t\tif (debugWrapper) {\n\t\t\tdebugWrapper.remove();\n\t\t}\n\t\tdelete this.debugStates[id];\n\t}\n\n\t// Tab controls\n\n\tprivate addTab(namespace: string): void {\n\t\tif (this.tabEntries[namespace]) return;\n\n\t\tthis.tabEntries[namespace] = [];\n\n\t\tconst tab = document.createElement('button');\n\t\ttab.classList.add('debug-tab');\n\t\ttab.textContent = namespace;\n\t\ttab.onclick = () => this.switchTab(namespace);\n\t\tthis.tabContainer.appendChild(tab);\n\n\t\tconst content = document.createElement('div');\n\t\tcontent.classList.add('debug-tab-content');\n\t\tcontent.dataset.namespace = namespace;\n\t\tthis.contentContainer.appendChild(content);\n\n\t\tif (Object.keys(this.tabEntries).length === 1) {\n\t\t\tthis.switchTab(namespace);\n\t\t}\n\t}\n\n\tprivate clearCurrentTab(): void {\n\t\tthis.clearTab(this.activeTab);\n\t}\n\n\tprivate clearTab(namespace: string): void {\n\t\tconst content = this.contentContainer.querySelector(`[data-namespace=\"${namespace}\"]`);\n\t\tif (!content) return;\n\n\t\t// Clear the data\n\t\tthis.tabEntries[namespace] = [];\n\n\t\tif (namespace === DEBUG_STATE_NAMESPACE) {\n\t\t\t// Clear debug states\n\t\t\tObject.keys(this.debugStates).forEach((key) => {\n\t\t\t\tdelete this.debugStates[key];\n\t\t\t});\n\t\t}\n\n\t\t// Remove all children from content\n\t\tcontent.innerHTML = '';\n\t}\n\n\tprivate switchTab(namespace: string): void {\n\t\tthis.activeTab = namespace;\n\n\t\t// Update tab buttons\n\t\tthis.tabContainer.querySelectorAll('.debug-tab').forEach((tab, index) => {\n\t\t\tconst tabNamespace = Object.keys(this.tabEntries)[index];\n\t\t\ttab.classList.toggle('active', tabNamespace === namespace);\n\t\t});\n\n\t\t// Update content visibility\n\t\tthis.contentContainer.querySelectorAll('.debug-tab-content').forEach((el) => {\n\t\t\t(el as HTMLElement).style.display = 'none';\n\t\t});\n\n\t\tconst activeContent = this.contentContainer.querySelector(`[data-namespace=\"${namespace}\"]`) as HTMLElement;\n\t\tif (activeContent) {\n\t\t\tactiveContent.style.display = 'block';\n\t\t}\n\t}\n\n\t// Log controls\n\n\tpublic log(namespace: string, message: Array<any> | object | string): void {\n\t\tif (!this.tabEntries[namespace]) {\n\t\t\tthis.addTab(namespace);\n\t\t}\n\n\t\tconst logEntry: LogEntry = {\n\t\t\tid: `${namespace}-${Date.now()}-${Math.random()}`,\n\t\t\tmessage,\n\t\t\ttimestamp: new Date()\n\t\t};\n\t\tthis.tabEntries[namespace].push(logEntry);\n\n\t\tconst content = this.contentContainer.querySelector(`[data-namespace=\"${namespace}\"]`);\n\t\tif (!content) return;\n\n\t\tconst logElement = this.createLogElement(logEntry, namespace);\n\t\tcontent.appendChild(logElement);\n\n\t\t// Add to global tab if not already global\n\t\tif (namespace !== 'global') {\n\t\t\tthis.log('global', message);\n\t\t}\n\t}\n\n\tprivate createLogElement(logEntry: LogEntry, namespace: string): HTMLElement {\n\t\tconst logElement = document.createElement('div');\n\t\tlogElement.classList.add('debug-log-entry');\n\t\tlogElement.dataset.logId = logEntry.id;\n\n\t\tconst logText = document.createElement('div');\n\t\tlogText.innerText = `[${logEntry.timestamp.toLocaleTimeString()}] ${this.renderLogEntry(logEntry.message)}`;\n\t\tlogText.classList.add('debug-log-entry-text');\n\n\t\tconst copyButton = document.createElement('button');\n\t\tcopyButton.innerText = '📋';\n\t\tcopyButton.classList.add('debug-copy-button');\n\t\tcopyButton.onclick = () => navigator.clipboard.writeText(logText.innerText);\n\n\t\tconst deleteButton = document.createElement('button');\n\t\tdeleteButton.innerText = '❌';\n\t\tdeleteButton.classList.add('debug-delete-button');\n\t\tdeleteButton.onclick = () => this.removeLogEntry(namespace, logEntry.id, logElement);\n\n\t\tlogElement.appendChild(logText);\n\t\tlogElement.appendChild(copyButton);\n\t\tlogElement.appendChild(deleteButton);\n\n\t\treturn logElement;\n\t}\n\n\tprivate removeLogEntry(namespace: string, logId: string, logElement: HTMLElement): void {\n\t\tthis.tabEntries[namespace] = this.tabEntries[namespace].filter((entry) => entry.id !== logId);\n\t\tlogElement.remove();\n\t}\n\n\tprivate renderLogEntry(message: any): string {\n\t\tif (Array.isArray(message)) {\n\t\t\treturn message.join(' ');\n\t\t}\n\t\tif (typeof message === 'object') {\n\t\t\treturn safeStringify(message);\n\t\t}\n\t\treturn String(message);\n\t}\n\n\t// Misc UI helpers\n\n\tprivate updateToolbarLayout(width: number): void {\n\t\t// Toggle narrow-panel class based on width\n\t\tif (width < MIN_WIDTH) {\n\t\t\tthis.container.classList.add('narrow-panel');\n\t\t} else {\n\t\t\tthis.container.classList.remove('narrow-panel');\n\t\t}\n\t}\n\n\tprivate handleOpacityChange(): void {\n\t\tconst opacityPercent = parseInt(this.opacitySlider.value);\n\t\tconst opacity = opacityPercent / 100;\n\n\t\t// Only set opacity when visible\n\t\tif (this.container.classList.contains('visible')) {\n\t\t\tthis.container.style.opacity = String(opacity);\n\t\t}\n\n\t\tthis.saveSettings();\n\t}\n\n\tprivate handleSnapWhileDragging(x: number, y: number): { x: number; y: number } {\n\t\tconst snapPadding = this.options.snapPadding || 20;\n\t\tconst { width: windowWidth, height: windowHeight } = getWindowSize();\n\t\tconst panelWidth = this.container.offsetWidth;\n\t\tconst panelHeight = this.container.offsetHeight;\n\n\t\tlet snappedX = x;\n\t\tlet snappedY = y;\n\n\t\t// Snap to left edge\n\t\tif (x < snapPadding) {\n\t\t\tsnappedX = 0;\n\t\t}\n\t\t// Snap to right edge\n\t\telse if (x + panelWidth > windowWidth - snapPadding) {\n\t\t\tsnappedX = windowWidth - panelWidth;\n\t\t}\n\n\t\t// Snap to top edge\n\t\tif (y < snapPadding) {\n\t\t\tsnappedY = 0;\n\t\t}\n\t\t// Snap to bottom edge\n\t\telse if (y + panelHeight > windowHeight - snapPadding) {\n\t\t\tsnappedY = windowHeight - panelHeight;\n\t\t}\n\n\t\t// Return the snapped coordinates\n\t\treturn { x: snappedX, y: snappedY };\n\t}\n\n\t// Panel controls\n\n\tpublic show(): void {\n\t\tthis.container.classList.add('visible');\n\t\t// Restore the opacity setting when showing\n\t\tconst opacity = parseFloat(this.container.style.opacity) || 1;\n\t\tthis.container.style.opacity = String(opacity);\n\t\tthis.saveSettings();\n\t}\n\n\tpublic hide(): void {\n\t\tthis.container.classList.remove('visible');\n\t\tthis.saveSettings();\n\t}\n\n\tpublic toggle(): void {\n\t\tif (this.container.classList.contains('visible')) {\n\t\t\tthis.hide();\n\t\t} else {\n\t\t\tthis.show();\n\t\t}\n\t}\n}\n\n// Utility function to send state to debug panel\nexport function debug(idOrState: string, state?: any): void {\n\tEventBus.dispatch('debug', { id: idOrState, state });\n}","\nexport const COLLAPSED_INDICATOR = '►';\nexport const EXPANDED_INDICATOR = '▼';","import * as jsondiffpatch from 'jsondiffpatch';\nimport { COLLAPSED_INDICATOR, EXPANDED_INDICATOR } from '../constants';\n\nexport type JsonViewOptions = {\n\texpandAll?: boolean;\n\texpandObjs?: Array<string | RegExp>;\n\tuseViewState?: boolean;\n};\n\nconst DEFAULT_OPTIONS = () => ({\n\texpandAll: false,\n\texpandObjects: [],\n\tuseViewState: true\n});\n\nexport class JsonView {\n\tprivate json: any;\n\tprivate parentContainer: HTMLElement;\n\tprivate options: JsonViewOptions;\n\tprivate viewStates: { [key: string]: boolean } = {}; // viewstate tree for retaining view during state updates\n\n\tconstructor(json: any, parentContainer: HTMLElement, options?: JsonViewOptions) {\n\t\tthis.json = json;\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.options = Object.assign({}, DEFAULT_OPTIONS(), options || {});\n\t\tthis.render();\n\t}\n\n\tprivate render(): void {\n\t\tthis.parentContainer.innerHTML = ''; // Clear existing content\n\t\tconst rootNode = this.drawJsonNode(this.json);\n\t\tthis.parentContainer.appendChild(rootNode);\n\t}\n\n\tprivate toggleExpandNode(childNode: HTMLElement, keyPath: string, toggleButton?: HTMLElement) {\n\t\tconst isCollapsed = childNode.classList.contains('collapsed');\n\t\tchildNode.classList.toggle('collapsed', !isCollapsed);\n\t\tthis.viewStates[keyPath] = !isCollapsed;\n\t\tif (toggleButton) toggleButton.textContent = !isCollapsed ? COLLAPSED_INDICATOR : EXPANDED_INDICATOR;\n\t}\n\n\tprivate drawJsonNode(jsonObj: any, currPath: string = ''): HTMLElement {\n\t\tconst nodeContainer = document.createElement('div');\n\t\tnodeContainer.classList.add('json-node');\n\t\tconst propertiesContainer = document.createElement('div');\n\t\tpropertiesContainer.classList.add('json-properties');\n\n\t\tfor (const key in jsonObj) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(jsonObj, key)) {\n\t\t\t\tconst keyPath = `${currPath}${key}`;\n\t\t\t\tconst propertyRow = document.createElement('div');\n\t\t\t\tpropertyRow.classList.add('json-property');\n\t\t\t\tpropertyRow.setAttribute('data-path', keyPath);\n\n\t\t\t\tconst label = document.createElement('span');\n\t\t\t\tlabel.classList.add('json-key');\n\t\t\t\tlabel.textContent = key + ': ';\n\n\t\t\t\tconst valueContainer = document.createElement('div');\n\t\t\t\tvalueContainer.classList.add('json-value');\n\n\t\t\t\tconst value = jsonObj[key];\n\t\t\t\tconst isObject = typeof value === 'object' && value !== null;\n\t\t\t\tconst isArray = Array.isArray(value);\n\n\t\t\t\tif (isObject) {\n\t\t\t\t\tlabel.classList.add('clickable');\n\t\t\t\t\tif (isArray) label.textContent = `${key} (${value.length})`;\n\t\t\t\t\telse label.textContent = key;\n\t\t\t\t\tconst hasChildren = isArray && value.length > 0 ? true : Object.keys(value).length > 0;\n\t\t\t\t\tpropertyRow.classList.add('object');\n\t\t\t\t\t// Create expandable/collapsible toggle button\n\t\t\t\t\tconst toggleButton = document.createElement('button');\n\t\t\t\t\ttoggleButton.classList.add('json-toggle');\n\n\t\t\t\t\t// Recursive call to render child object\n\t\t\t\t\tconst childNode = this.drawJsonNode(value, keyPath + '/');\n\n\t\t\t\t\tif (this.options.expandAll) {\n\t\t\t\t\t\ttoggleButton.textContent = EXPANDED_INDICATOR;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet expand = false;\n\t\t\t\t\t\t// expand empty objects by default:\n\t\t\t\t\t\tif (isArray && hasChildren) {\n\t\t\t\t\t\t\texpand = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.options.expandObjs?.forEach((e) => {\n\t\t\t\t\t\t\t\tif (new RegExp(e).test(keyPath)) expand = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// if a viewstate exists use that always:\n\t\t\t\t\t\tif (this.options.useViewState) {\n\t\t\t\t\t\t\tif (typeof this.viewStates[keyPath] !== 'undefined') expand = !this.viewStates[keyPath];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (expand) {\n\t\t\t\t\t\t\ttoggleButton.textContent = EXPANDED_INDICATOR;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoggleButton.textContent = COLLAPSED_INDICATOR;\n\t\t\t\t\t\t\tchildNode.classList.add('collapsed'); // Start collapsed\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Toggle function for expanding/collapsing\n\t\t\t\t\ttoggleButton.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\t\t\t\t\tlabel.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\n\t\t\t\t\tpropertyRow.appendChild(toggleButton);\n\t\t\t\t\tvalueContainer.appendChild(childNode);\n\t\t\t\t} else {\n\t\t\t\t\tvalueContainer.textContent = String(value);\n\t\t\t\t}\n\n\t\t\t\tpropertyRow.appendChild(label);\n\t\t\t\tpropertyRow.appendChild(valueContainer);\n\t\t\t\tpropertiesContainer.appendChild(propertyRow);\n\t\t\t}\n\t\t}\n\n\t\tnodeContainer.appendChild(propertiesContainer);\n\t\treturn nodeContainer;\n\t}\n\n\tpublic updateJson(newJson: any): void {\n\t\tconst delta = jsondiffpatch.diff(this.json, newJson);\n\t\tif (!delta) return; // No changes\n\n\t\t// Update only the changed DOM nodes, passing newJson so getValueAtPath can use it\n\t\tthis.patchDOM(delta, '', newJson);\n\n\t\t// Update the reference to the new JSON data\n\t\tthis.json = newJson;\n\t}\n\n\tprivate patchDOM(delta: any, currentPath: string = '', newJson?: any): void {\n\t\tconst sourceJson = newJson || this.json;\n\n\t\tfor (const key in delta) {\n\t\t\tif (!Object.prototype.hasOwnProperty.call(delta, key)) continue;\n\n\t\t\tconst change = delta[key];\n\t\t\tconst keyPath = currentPath ? `${currentPath}${key}` : key;\n\n\t\t\t// Check if this is a jsondiffpatch operation marker\n\t\t\tif (key === '_t') continue; // Array marker\n\n\t\t\t// Find the DOM node for this path\n\t\t\tconst propertyNode = this.parentContainer.querySelector(\n\t\t\t\t`.json-property[data-path=\"${keyPath}\"]`\n\t\t\t) as HTMLElement;\n\n\t\t\tif (Array.isArray(change)) {\n\t\t\t\t// Simple value change: [oldValue, newValue]\n\t\t\t\tif (change.length === 2) {\n\t\t\t\t\tconst newValue = this.getValueAtPath(sourceJson, keyPath);\n\t\t\t\t\tthis.updateValueNode(propertyNode, keyPath, newValue);\n\t\t\t\t}\n\t\t\t\t// Deleted value: [oldValue, 0, 0]\n\t\t\t\telse if (change.length === 3 && change[1] === 0 && change[2] === 0) {\n\t\t\t\t\tif (propertyNode) propertyNode.remove();\n\t\t\t\t}\n\t\t\t\t// New value: [newValue]\n\t\t\t\telse if (change.length === 1) {\n\t\t\t\t\tthis.addPropertyNode(keyPath, change[0]);\n\t\t\t\t}\n\t\t\t} else if (typeof change === 'object') {\n\t\t\t\t// Nested object changes - recurse\n\t\t\t\tthis.patchDOM(change, keyPath + '/', sourceJson);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getValueAtPath(obj: any, path: string): any {\n\t\tconst parts = path.split('/').filter((p) => p);\n\t\tlet current = obj;\n\t\tfor (const part of parts) {\n\t\t\tif (current === null || current === undefined) return undefined;\n\t\t\tcurrent = current[part];\n\t\t}\n\t\treturn current;\n\t}\n\n\tprivate updateValueNode(propertyNode: HTMLElement | null, keyPath: string, newValue: any): void {\n\t\tif (!propertyNode) return;\n\n\t\tconst valueContainer = propertyNode.querySelector('.json-value') as HTMLElement;\n\t\tif (!valueContainer) return;\n\n\t\tconst isObject = typeof newValue === 'object' && newValue !== null;\n\n\t\tif (isObject) {\n\t\t\t// Object/array changed - need to redraw the entire subtree\n\t\t\tconst key = keyPath.split('/').filter((p) => p).pop() || '';\n\t\t\tconst parentPath = keyPath.substring(0, keyPath.lastIndexOf(key));\n\n\t\t\t// Clear old content\n\t\t\tvalueContainer.innerHTML = '';\n\t\t\tpropertyNode.classList.add('object');\n\n\t\t\t// Redraw the node\n\t\t\tconst label = propertyNode.querySelector('.json-key') as HTMLElement;\n\t\t\tconst isArray = Array.isArray(newValue);\n\n\t\t\tif (label) {\n\t\t\t\tlabel.classList.add('clickable');\n\t\t\t\tif (isArray) {\n\t\t\t\t\tlabel.textContent = `${key} (${newValue.length})`;\n\t\t\t\t} else {\n\t\t\t\t\tlabel.textContent = key;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Check if toggle button already exists\n\t\t\tlet toggleButton = propertyNode.querySelector('.json-toggle') as HTMLElement;\n\t\t\tif (!toggleButton) {\n\t\t\t\ttoggleButton = document.createElement('button');\n\t\t\t\ttoggleButton.classList.add('json-toggle');\n\t\t\t\tpropertyNode.insertBefore(toggleButton, label);\n\t\t\t}\n\n\t\t\t// Recursive call to render child object\n\t\t\tconst childNode = this.drawJsonNode(newValue, keyPath + '/');\n\n\t\t\t// Preserve expand state if it exists\n\t\t\tconst wasExpanded = this.viewStates[keyPath];\n\t\t\tif (typeof wasExpanded !== 'undefined') {\n\t\t\t\tif (wasExpanded) {\n\t\t\t\t\ttoggleButton.textContent = EXPANDED_INDICATOR;\n\t\t\t\t} else {\n\t\t\t\t\ttoggleButton.textContent = COLLAPSED_INDICATOR;\n\t\t\t\t\tchildNode.classList.add('collapsed');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttoggleButton.textContent = COLLAPSED_INDICATOR;\n\t\t\t\tchildNode.classList.add('collapsed');\n\t\t\t}\n\n\t\t\ttoggleButton.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\t\t\tif (label) {\n\t\t\t\tlabel.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\t\t\t}\n\n\t\t\tvalueContainer.appendChild(childNode);\n\t\t} else {\n\t\t\t// Simple value - just update text\n\t\t\tpropertyNode.classList.remove('object');\n\t\t\tconst toggleButton = propertyNode.querySelector('.json-toggle');\n\t\t\tif (toggleButton) toggleButton.remove();\n\n\t\t\tvalueContainer.innerHTML = '';\n\t\t\tvalueContainer.textContent = String(newValue);\n\t\t}\n\t}\n\n\tprivate addPropertyNode(keyPath: string, value: any): void {\n\t\tconst pathParts = keyPath.split('/').filter((p) => p);\n\t\tconst key = pathParts.pop() || '';\n\t\tconst parentPath = pathParts.join('/');\n\n\t\t// Find parent container\n\t\tlet parentContainer: HTMLElement | null;\n\t\tif (parentPath) {\n\t\t\tconst parentProperty = this.parentContainer.querySelector(\n\t\t\t\t`.json-property[data-path=\"${parentPath}\"]`\n\t\t\t) as HTMLElement;\n\t\t\tif (parentProperty) {\n\t\t\t\tparentContainer = parentProperty.querySelector('.json-properties') as HTMLElement;\n\t\t\t} else {\n\t\t\t\treturn; // Parent not found\n\t\t\t}\n\t\t} else {\n\t\t\tparentContainer = this.parentContainer.querySelector('.json-properties') as HTMLElement;\n\t\t}\n\n\t\tif (!parentContainer) return;\n\n\t\t// Create new property row\n\t\tconst propertyRow = document.createElement('div');\n\t\tpropertyRow.classList.add('json-property');\n\t\tpropertyRow.setAttribute('data-path', keyPath);\n\n\t\tconst label = document.createElement('span');\n\t\tlabel.classList.add('json-key');\n\t\tlabel.textContent = key + ': ';\n\n\t\tconst valueContainer = document.createElement('div');\n\t\tvalueContainer.classList.add('json-value');\n\n\t\tconst isObject = typeof value === 'object' && value !== null;\n\t\tconst isArray = Array.isArray(value);\n\n\t\tif (isObject) {\n\t\t\tlabel.classList.add('clickable');\n\t\t\tif (isArray) label.textContent = `${key} (${value.length})`;\n\t\t\telse label.textContent = key;\n\t\t\tpropertyRow.classList.add('object');\n\n\t\t\tconst toggleButton = document.createElement('button');\n\t\t\ttoggleButton.classList.add('json-toggle');\n\t\t\ttoggleButton.textContent = COLLAPSED_INDICATOR;\n\n\t\t\tconst childNode = this.drawJsonNode(value, keyPath + '/');\n\t\t\tchildNode.classList.add('collapsed');\n\n\t\t\ttoggleButton.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\t\t\tlabel.onclick = () => this.toggleExpandNode(childNode, keyPath, toggleButton);\n\n\t\t\tpropertyRow.appendChild(toggleButton);\n\t\t\tvalueContainer.appendChild(childNode);\n\t\t} else {\n\t\t\tvalueContainer.textContent = String(value);\n\t\t}\n\n\t\tpropertyRow.appendChild(label);\n\t\tpropertyRow.appendChild(valueContainer);\n\t\tparentContainer.appendChild(propertyRow);\n\t}\n}","export type ResizeOptions = {\n\thandles?: ('top' | 'left' | 'right' | 'bottom' | 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right')[];\n\tmaxWidth?: number;\n\tmaxHeight?: number;\n\tminWidth?: number;\n\tminHeight?: number;\n\tonResize?: (width: number, height: number) => void;\n};\n\nexport function makeResizable(container: HTMLElement, options: ResizeOptions = {}) {\n\t// Remove existing handles\n\tcontainer.querySelectorAll('.resize-handle').forEach((handle) => handle.remove());\n\n\t// Default options - now includes all sides and corners\n\tconst {\n\t\thandles = ['top', 'left', 'right', 'bottom', 'top-left', 'top-right', 'bottom-left', 'bottom-right'],\n\t\tmaxWidth = Infinity,\n\t\tmaxHeight = Infinity,\n\t\tminWidth = 100,\n\t\tminHeight = 100,\n\t\tonResize = () => { }\n\t} = options;\n\n\tlet resizing = false;\n\tlet resizeDirection: string | null = null;\n\tlet startX = 0,\n\t\tstartY = 0;\n\tlet startWidth = 0,\n\t\tstartHeight = 0;\n\tlet startLeft = 0,\n\t\tstartTop = 0;\n\n\tfunction createHandle(position: string) {\n\t\tconst handle = document.createElement('div');\n\t\thandle.classList.add('resize-handle', `resize-${position}`);\n\t\thandle.addEventListener('mousedown', (e) => startResizing(e, position));\n\t\tcontainer.appendChild(handle);\n\t}\n\n\tfunction startResizing(event: MouseEvent, direction: string) {\n\t\tresizing = true;\n\t\tresizeDirection = direction;\n\t\tstartX = event.clientX;\n\t\tstartY = event.clientY;\n\n\t\t// Capture initial dimensions and position\n\t\tstartWidth = container.offsetWidth;\n\t\tstartHeight = container.offsetHeight;\n\t\tstartLeft = container.offsetLeft;\n\t\tstartTop = container.offsetTop;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tdocument.addEventListener('mousemove', resize);\n\t\tdocument.addEventListener('mouseup', stopResizing);\n\t}\n\n\tfunction resize(event: MouseEvent) {\n\t\tif (!resizing || !resizeDirection) return;\n\n\t\tlet newWidth = startWidth;\n\t\tlet newHeight = startHeight;\n\t\tlet newLeft = startLeft;\n\t\tlet newTop = startTop;\n\n\t\tconst deltaX = event.clientX - startX;\n\t\tconst deltaY = event.clientY - startY;\n\n\t\t// Handle horizontal resizing\n\t\tif (resizeDirection.includes('right')) {\n\t\t\tnewWidth = Math.min(Math.max(startWidth + deltaX, minWidth), maxWidth);\n\t\t}\n\t\tif (resizeDirection.includes('left')) {\n\t\t\tconst potentialWidth = startWidth - deltaX;\n\t\t\tif (potentialWidth >= minWidth && potentialWidth <= maxWidth) {\n\t\t\t\tnewWidth = potentialWidth;\n\t\t\t\tnewLeft = startLeft + deltaX;\n\t\t\t}\n\t\t}\n\n\t\t// Handle vertical resizing\n\t\tif (resizeDirection.includes('bottom')) {\n\t\t\tnewHeight = Math.min(Math.max(startHeight + deltaY, minHeight), maxHeight);\n\t\t}\n\t\tif (resizeDirection.includes('top')) {\n\t\t\tconst potentialHeight = startHeight - deltaY;\n\t\t\tif (potentialHeight >= minHeight && potentialHeight <= maxHeight) {\n\t\t\t\tnewHeight = potentialHeight;\n\t\t\t\tnewTop = startTop + deltaY;\n\t\t\t}\n\t\t}\n\n\t\tcontainer.style.width = `${newWidth}px`;\n\t\tcontainer.style.height = `${newHeight}px`;\n\t\tcontainer.style.left = `${newLeft}px`;\n\t\tcontainer.style.top = `${newTop}px`;\n\n\t\tonResize(newWidth, newHeight);\n\t}\n\n\tfunction stopResizing() {\n\t\tresizing = false;\n\t\tresizeDirection = null;\n\t\tdocument.removeEventListener('mousemove', resize);\n\t\tdocument.removeEventListener('mouseup', stopResizing);\n\t}\n\n\t// Add handles based on config\n\thandles.forEach((handle) => createHandle(handle));\n}\n\nexport type DragOptions = {\n\tonDragStart?: (e: MouseEvent) => void;\n\tonDrag?: (x: number, y: number) => void | { x?: number; y?: number };\n\tonDragEnd?: () => void;\n};\n\nexport function makeDraggable(\n\telement: HTMLElement,\n\thandleElement?: HTMLElement,\n\toptions: DragOptions = {}\n) {\n\tconst dragHandle = handleElement || element;\n\tlet isDragging = false;\n\tlet startX = 0;\n\tlet startY = 0;\n\tlet initialLeft = 0;\n\tlet initialTop = 0;\n\n\tconst { onDragStart, onDrag, onDragEnd } = options;\n\n\tfunction startDragging(event: MouseEvent) {\n\t\t// Don't start dragging if clicking on buttons or interactive elements\n\t\tconst target = event.target as HTMLElement;\n\t\tif (target.tagName === 'BUTTON' || target.closest('button')) {\n\t\t\treturn;\n\t\t}\n\n\t\tisDragging = true;\n\t\tstartX = event.clientX;\n\t\tstartY = event.clientY;\n\n\t\t// Get current computed position (handles both absolute and other positioning)\n\t\tconst computedStyle = getComputedStyle(element);\n\t\tinitialLeft = parseInt(computedStyle.left) || element.offsetLeft;\n\t\tinitialTop = parseInt(computedStyle.top) || element.offsetTop;\n\n\t\t// Ensure element has position fixed or absolute for dragging\n\t\tif (computedStyle.position !== 'absolute' && computedStyle.position !== 'fixed') {\n\t\t\telement.style.position = 'absolute';\n\t\t\telement.style.left = `${initialLeft}px`;\n\t\t\telement.style.top = `${initialTop}px`;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tdragHandle.style.cursor = 'grabbing';\n\n\t\tif (onDragStart) onDragStart(event);\n\n\t\tdocument.addEventListener('mousemove', drag);\n\t\tdocument.addEventListener('mouseup', stopDragging);\n\t}\n\n\tfunction drag(event: MouseEvent) {\n\t\tif (!isDragging) return;\n\n\t\tconst deltaX = event.clientX - startX;\n\t\tconst deltaY = event.clientY - startY;\n\n\t\tlet newLeft = initialLeft + deltaX;\n\t\tlet newTop = initialTop + deltaY;\n\n\t\t// Call onDrag callback which may modify the position (e.g., for snapping)\n\t\tif (onDrag) {\n\t\t\tconst result = onDrag(newLeft, newTop);\n\t\t\t// If onDrag returns adjusted coordinates, use them\n\t\t\tif (result && typeof result === 'object') {\n\t\t\t\tif (typeof result.x === 'number') newLeft = result.x;\n\t\t\t\tif (typeof result.y === 'number') newTop = result.y;\n\t\t\t}\n\t\t}\n\n\t\telement.style.left = `${newLeft}px`;\n\t\telement.style.top = `${newTop}px`;\n\t}\n\n\tfunction stopDragging() {\n\t\tif (!isDragging) return;\n\n\t\tisDragging = false;\n\t\tdragHandle.style.cursor = 'grab';\n\n\t\tif (onDragEnd) onDragEnd();\n\n\t\tdocument.removeEventListener('mousemove', drag);\n\t\tdocument.removeEventListener('mouseup', stopDragging);\n\t}\n\n\t// Set up drag handle cursor\n\tdragHandle.style.cursor = 'grab';\n\tdragHandle.addEventListener('mousedown', startDragging);\n\n\t// Return cleanup function\n\treturn () => {\n\t\tdragHandle.removeEventListener('mousedown', startDragging);\n\t\tdocument.removeEventListener('mousemove', drag);\n\t\tdocument.removeEventListener('mouseup', stopDragging);\n\t};\n}\n\nexport function getWindowSize(): { width: number; height: number } {\n\tconst width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n\tconst height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\treturn { width, height };\n}\n"],"mappings":"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","names":["css","ScreenPosition"]}